

DROP TABLE `old_institution`, `reference`, `school`;



DROP TABLE IF EXISTS message;
CREATE TABLE message (
  id bigint(20) NOT NULL AUTO_INCREMENT,
  message_type varchar(300) NOT NULL,
  `subject` varchar(300) NOT NULL,
  details text NOT NULL,
  sms varchar(300) NOT NULL,
  copy_admin enum('Y','N') NOT NULL DEFAULT 'Y',
  date_added datetime NOT NULL,
  added_by varchar(100) NOT NULL,
  last_updated datetime NOT NULL,
  last_updated_by varchar(100) NOT NULL,
  PRIMARY KEY (id)
) ENGINE=InnoDB  DEFAULT CHARSET=latin1;

INSERT INTO message (id, message_type, subject, details, sms, copy_admin, date_added, added_by, last_updated, last_updated_by) VALUES
(1, 'new_teacher_first_step', 'Your Verification Code for TMIS', 'A profile has been created for you at the Teacher Management Information System (TMIS). You will need this code to confirm your account:\n<br>_VERIFICATION_CODE_\n<br>\n<br>In case you closed the TMIS website, go to the link below to continue with your registration:\n<br>_LOGIN_LINK_\n<br>You will need the following details to login:\n<br>\nYour user name: _EMAILADDRESS_\n<br>Your Temporary Password: _PASSWORD_\n<br>\n<br>Regards,\n<br>Your TMIS Admin Team\n<br>', 'Your TMIS profile has been created. Confirm your account at _LOGIN_LINK_ with code: _VERIFICATION_CODE_ Login with username: _EMAILADDRESS_ and password: _PASSWORD_', 'Y', '2015-01-14 00:00:00', '1', '0000-00-00 00:00:00', ''),
(2, 'teacher_application_submitted', 'Your TMIS Application Has Been Submitted', 'Your TMIS application has been submitted for review. You will be notified by email when it is approved for you to begin enjoying the benefits of a TMIS registered teacher.\n<br>\n<br>In case you closed the TMIS website, go to the link below to learn more about TMIS:\n<br>_LOGIN_LINK_\n<br>\n<br>Regards,\n<br>Your TMIS Admin Team\n<br>', 'Your TMIS application has been submitted for review.', 'Y', '2015-01-16 00:00:00', '1', '2015-01-16 00:00:00', '1'),
(3, 'notify_next_chain_party', 'Your Approval at TMIS is Required By _ORIGINATOR_NAME_', 'Your approval at TMIS is required by _ORIGINATOR_NAME_ for a _ITEM_TYPE_. This was requested on _ACTION_DATE_.\n<br>\n<br>Regards,\n<br>Your TMIS Admin Team\n<br>', 'Your TMIS approval is required by _ORIGINATOR_NAME_ for a _ITEM_TYPE_.', 'Y', '2015-01-23 00:00:00', '1', '2015-01-23 00:00:00', '1'),
(4, 'notify_previous_chain_parties', 'A _ITEM_TYPE_ has been _VERIFICATION_RESULT_ by _APPROVER_NAME_', 'The _ITEM_TYPE_ you acted on at TMIS has been _VERIFICATION_RESULT_ by _APPROVER_NAME_. This action was taken on _ACTION_DATE_. \n<br>\n<br>Regards,\n<br>Your TMIS Admin Team\n<br>', 'The _ITEM_TYPE_ you acted on at TMIS has been _VERIFICATION_RESULT_ by _APPROVER_NAME_.', 'Y', '2015-01-23 00:00:00', '1', '2015-01-23 00:00:00', '1'),
(5, 'document__confirmation_letter', '', '<table width=''100%'' cellpadding=''5'' cellspacing=''0'' style=''font-family: Georgia, &quot;Times New Roman&quot;, Times, serif;''>\r\n<tr><td align=''left'' valign=''top''><table width=''100%'' cellpadding=''5'' cellspacing=''0'' style=''border-bottom: solid 3px #000;''>\r\n  <tr>\r\n    <td valign=''top'' style=''padding-top: 20px; padding-bottom: 0px; text-align:left;''><table border=''0'' cellspacing=''0'' cellpadding=''2'' align=''left'' style=''font-weight:bold;''>\r\n      <tr>\r\n        <td>Telephone:</td>\r\n        <td>0412 34451/4</td>\r\n      </tr>\r\n      <tr>\r\n        <td>Fax:</td>\r\n        <td>0412 234920</td>\r\n      </tr>\r\n      <tr>\r\n        <td>Email:</td>\r\n        <td>pro@education.co.ug</td>\r\n      </tr>\r\n      <tr>\r\n        <td>Website:</td>\r\n        <td>www.education.co.ug</td>\r\n      </tr>\r\n    </table></td>\r\n    <td style=''padding-top: 0px; padding-bottom: 0px; text-align:center;'' nowrap><img src=''_ASSET_FOLDER_images/coat_of_arms.png'' border=''0''/><br /><span  style=''font-family:&quot;Times New Roman&quot;, Times, serif; font-size: 12px; font-weight:bold; text-align:center;''>REPUBLIC OF UGANDA</span></td>\r\n    <td style=''padding-top: 20px; padding-bottom: 10px; text-align:right;''><table border=''0'' cellspacing=''0'' cellpadding=''2'' style=''font-weight:bold;'' align=''right''>\r\n      <tr>\r\n        <td nowrap>Ministry of Education and Sports</td>\r\n        </tr>\r\n      <tr>\r\n        <td>Embassy House</td>\r\n        </tr>\r\n      <tr>\r\n        <td>P.O. Box 7063</td>\r\n        </tr>\r\n      <tr>\r\n        <td>Kampala Uganda</td>\r\n        </tr>\r\n    </table></td>\r\n    </tr>\r\n</table></td></tr>\r\n<tr>\r\n  <td>\r\n  \r\n  <table width=''100%'' cellpadding=''5'' cellspacing=''0''>\r\n  <tr><td><table border=''0'' cellspacing=''0'' cellpadding=''3'' style=''font-weight:bold;''>\r\n      <tr>\r\n        <td colspan=''2'' style=''height:40px; color:#999; vertical-align:top;''>_DATE_TODAY_</td>\r\n        </tr>\r\n      <tr>\r\n        <td colspan=''2'' style=''font-weight:normal;''>_TEACHER_NAME_</td>\r\n        </tr>\r\n      <tr>\r\n        <td colspan=''2'' style=''height:40px; vertical-align:top;''>_NEW_POSITION_</td>\r\n        </tr>\r\n      <tr>\r\n        <td valign=''top'' width=''1%''>Thru:</td>\r\n        <td width=''99%'' style=''font-weight:normal; line-height:160%;''>The Head Teacher,<br />\r\n_SCHOOL_NAME_<br />\r\n_SCHOOL_ADDRESS_</td>\r\n      </tr>\r\n    </table></td><td valign=''top''><table border=''0'' cellspacing=''0'' cellpadding=''0'' align=''right''>\r\n      <tr>\r\n        <td style=''height:30px; color:#999;''>&nbsp;</td>\r\n      </tr>\r\n      <tr>\r\n        <td style=''font-weight:normal;''>_TRACKING_IMAGE_</td>\r\n      </tr>\r\n      <tr>\r\n        <td style=''font-family:&quot;Courier New&quot;, Courier, monospace; text-align:center;color:#999;''>_TRACKING_NUMBER_<br />\r\n          <span style=''font-size:9px; font-family:Arial, Helvetica, sans-serif; font-weight:bold;color:#999;''><br />QUOTE TRACKING NUMBER IN <br />FUTURE CORRESPONDENCE.</span></td>\r\n      </tr>\r\n    </table></td></tr>\r\n  </table>\r\n  \r\n\r\n  </td>\r\n</tr>\r\n\r\n\r\n<tr><td>&nbsp;</td></tr>\r\n\r\n\r\n<tr>\r\n  <td style=''line-height:160%;''><span style=''font-weight:bold''>RE: CONFIRMATION OF APPOINTMENT</span><br />\r\n    I am pleased to inform you that the Education Service Commission under Minute No. _MINUTE_NUMBER_, directed that you be confirmed in your appointment as <span style=''font-weight:bold;''>_NEW_POSITION_</span> and admitted to the permanent and pensionable establishment of the Public Service with effect from the date of appointment on probation.<br />\r\n    <br />\r\n    Your attention is drawn to the Uganda Public Service Standing Orders 2010 Section <span style=''font-weight:bold;''>a-e</span> paragraphs <span style=''font-weight:bold;''>10-13</span> which explain the effect of confirmation.<br />\r\n    <br />\r\n    Yours faithfully,</td>\r\n</tr>\r\n<tr>\r\n  <td><br /><img src=''_ASSET_FOLDER_uploads/images/_APPROVER_SIGNATURE_'' border=''0'' style=''height:80px;'' />\r\n<br /><br />_APPROVER_NAME_\r\n<br /><span style=''font-weight:bold;''>For: PERMANENT SECRETARY</span></td>\r\n</tr>\r\n<tr>\r\n  <td style=''line-height:160%;''>C.C: The Auditor General, Audit Commission <br />\r\n    C.C: \r\n    Permanent Secretary, Ministry of Public Service<br />\r\n    C.C: Secretary, Education Service Commission<br />\r\n    C.C: Personal File\r\n  </td>\r\n</tr>\r\n<tr>\r\n  <td style=''border-top: solid 3px #000;''><table border=''0'' cellspacing=''0'' cellpadding=''0'' width=''100%'' style=''font-weight:bold;''>\r\n    <tr>\r\n      <td style=''font-size:9px; font-family:Arial, Helvetica, sans-serif; font-weight:bold; color:#999;''>THIS LETTER HAS AN ELECTRONIC RECORD. MODIFICATION OR FORGERY IS PUNISHABLE BY LAW.</td>\r\n      <td style=''font-size:9px; font-family:Arial, Helvetica, sans-serif; font-weight:bold; text-align:right;''>FORM: C-510A &nbsp;&nbsp; 01-DEC-2014</td>\r\n    </tr>\r\n  </table></td>\r\n</tr>\r\n</table>', '', 'Y', '2015-01-24 00:00:00', '1', '2015-01-24 00:00:00', '1'),
(6, 'issue_file_number', 'You Have Been Issued a Teacher File Number', 'You have been issued a file number: _FILE_NUMBER_.\n<br>\n<br>Use it in any of your correspondence with the ministry to allow us to process your case faster.\n<br>\n<br>Regards,\n<br>Your TMIS Admin Team\n<br>\n', 'You have been issued a file number: _FILE_NUMBER_. Use it in any of your correspondence with the Ministry of Education.', 'Y', '2015-01-24 00:00:00', '1', '2015-01-24 00:00:00', '1'),
(7, 'send_confirmation_letter', 'Your Confirmation Letter', 'You have been issued a confirmation letter for your application which is attached. You can also access it in the TMIS system using your account.\n<br>\n<br>Regards,\n<br>Your TMIS Admin Team\n<br>', 'Your confirmation letter has been sent.', 'Y', '2015-01-24 00:00:00', '1', '2015-01-24 00:00:00', '1'),
(8, 'document__registration_certificate', '', '<table width=''100%'' cellpadding=''0'' cellspacing=''0''>\r\n<tr><td valign=''top'' align=''left''><img src=''_ASSET_FOLDER_images/top_left_corner.png'' border=''0''  height=''50''/></td><td><table width=''100%'' cellpadding=''5'' cellspacing=''0''>\r\n  <tr>\r\n    <td style=''padding-top: 0px; padding-bottom: 0px; text-align:center; line-height:160%;''><img src=''_ASSET_FOLDER_images/coat_of_arms.png'' border=''0'' height=''100''/> <br />\r\n      <span  style=''font-family:&quot;Times New Roman&quot;, Times, serif; font-size: 20px; text-align:center;''>REPUBLIC OF UGANDA</span><br>\r\n<span style=''font-family:&quot;Times New Roman&quot;, Times, serif; font-size: 20px; text-align:center; color:#999; '' nowrap>MINISTRY OF EDUCATION AND SPORTS</span></td>\r\n  </tr>\r\n</table></td><td valign=''top'' align=''right''><img src=''_ASSET_FOLDER_images/top_right_corner.png'' border=''0'' height=''50'' /></td></tr>\r\n<tr><td colspan=''3'' align=''center''><table width=''90%'' cellpadding=''5'' cellspacing=''0'' align=''center''>\r\n\r\n  <tr>\r\n    <td style=''text-align:center;padding-bottom:0px;''><img src=''_ASSET_FOLDER_images/certificate_heading.png'' height=''70''/><br>\r\n	<span style=''font-family:&quot;Times New Roman&quot;, Times, serif; font-size: 20px; text-align:center; padding-top:0px;padding-bottom:50px;''>(Issued under Sections 11, 12 and 13 of the Education Act, 2008)</span></td>\r\n  </tr>\r\n  <tr>\r\n    <td style=''font-family:&quot;Times New Roman&quot;, Times, serif; height:75px; padding-bottom:10px; font-size: 40px; text-align:center; vertical-align:bottom;''>This is to certify that</td>\r\n  </tr>\r\n  <tr>\r\n    <td style=''font-family:Arial, Helvetica, sans-serif; padding-bottom:10px; font-size: 30px; text-align:center; border-bottom: solid 2px #333;''>_TEACHER_NAME_</td>\r\n  </tr>\r\n  <tr>\r\n    <td style=''font-family:&quot;Times New Roman&quot;, Times, serif; font-size: 18px; text-align:center; padding-bottom:0px; line-height:160%;''>Having completed a teacher training course approved by the Ministry, has been registered<br />\r\n       under <b>_TEACHER_GRADE_</b> with effect from _EFFECTIVE_DATE_ as number <b>_CERTIFICATE_NUMBER_</b>.</td>\r\n  </tr>\r\n  <tr>\r\n    <td><table width=''100%'' cellpadding=''5'' cellspacing=''0''>\r\n      <tr>\r\n        <td style=''font-family:&quot;Times New Roman&quot;, Times, serif; font-size: 20px; text-align:left; color:#999; ''>_DATE_TODAY_</td>\r\n        <td style=''width:400px;''>For\r\n          <div style=''border-bottom: 1px solid #000; padding-bottom: 2px; width: 95%; margin-left:10px; display:inline-block;''><img src=''_ASSET_FOLDER_uploads/images/_SIGNATURE_URL_'' border=''0'' style=''height:80px;'' /></div>\r\n          <br />\r\n          <span style=''&quot;Times New Roman&quot;, Times, serif; font-size: 12px;''>DIRECTOR FOR HIGHER TECHNICAL, VOCATIONAL AND EDUCATIONAL TRAINING.</span></td>\r\n      </tr>\r\n    </table></td>\r\n  </tr>\r\n</table></td>\r\n  </tr>\r\n<tr><td valign=''bottom'' align=''left'' style=''padding-top:0px;''><img src=''_ASSET_FOLDER_images/bottom_left_corner.png'' border=''0'' height=''50'' /></td>\r\n  <td style=''text-align:center;padding-top:0px; padding-bottom:0px;''>&nbsp;</td>\r\n  <td valign=''bottom'' align=''right'' style=''padding-top:0px;''><img src=''_ASSET_FOLDER_images/bottom_right_corner.png'' border=''0'' height=''50'' /></td></tr>\r\n</table>', '', 'Y', '2015-01-24 00:00:00', '1', '2015-01-24 00:00:00', '1'),
(9, 'send_registration_certificate', 'Your Registration Certificate', 'You have been issued a registration certificate for your application which is attached. You can also access it in the TMIS system using your account.\n<br>\n<br>Regards,\n<br>Your TMIS Admin Team\n<br>', 'Your registration certificate has been sent.', 'Y', '2015-01-24 00:00:00', '1', '2015-01-24 00:00:00', '1'),
(10, 'document__transfer_letter', '', '<table width=''100%'' cellpadding=''5'' cellspacing=''0'' style=''font-family: Georgia, &quot;Times New Roman&quot;, Times, serif;''>\n<tr><td align=''left'' valign=''top''><table width=''100%'' cellpadding=''5'' cellspacing=''0'' style=''border-bottom: solid 3px #000;''>\n  <tr>\n    <td valign=''top'' style=''padding-top: 20px; padding-bottom: 0px; text-align:left;''><table border=''0'' cellspacing=''0'' cellpadding=''2'' align=''left'' style=''font-weight:bold;''>\n      <tr>\n        <td>Telephone:</td>\n        <td>0412 34451/4</td>\n      </tr>\n      <tr>\n        <td>Fax:</td>\n        <td>0412 234920</td>\n      </tr>\n      <tr>\n        <td>Email:</td>\n        <td>pro@education.co.ug</td>\n      </tr>\n      <tr>\n        <td>Website:</td>\n        <td>www.education.co.ug</td>\n      </tr>\n    </table></td>\n    <td style=''padding-top: 0px; padding-bottom: 0px; text-align:center;'' nowrap><img src=''_ASSET_FOLDER_images/coat_of_arms.png'' border=''0''/><br /><span  style=''font-family:&quot;Times New Roman&quot;, Times, serif; font-size: 12px; font-weight:bold; text-align:center;''>REPUBLIC OF UGANDA</span></td>\n    <td style=''padding-top: 20px; padding-bottom: 10px; text-align:right;''><table border=''0'' cellspacing=''0'' cellpadding=''2'' style=''font-weight:bold;'' align=''right''>\n      <tr>\n        <td nowrap>Ministry of Education and Sports</td>\n        </tr>\n      <tr>\n        <td>Embassy House</td>\n        </tr>\n      <tr>\n        <td>P.O. Box 7063</td>\n        </tr>\n      <tr>\n        <td>Kampala Uganda</td>\n        </tr>\n    </table></td>\n    </tr>\n</table></td></tr>\n<tr>\n  <td>\n  \n  <table width=''100%'' cellpadding=''5'' cellspacing=''0''>\n  <tr><td><table border=''0'' cellspacing=''0'' cellpadding=''3'' style=''font-weight:bold;''>\n      <tr>\n        <td colspan=''2'' style=''height:40px; color:#999; vertical-align:top;''>_DATE_TODAY_</td>\n        </tr>\n      <tr>\n        <td colspan=''2'' style=''font-weight:normal;''>_TEACHER_NAME_<br>REG._FILE_NUMBER_</td>\n        </tr>\n      <tr>\n        <td colspan=''2'' style=''height:40px; vertical-align:top;''>_NEW_POSITION_</td>\n        </tr>\n      <tr>\n        <td valign=''top'' width=''1%''>Thru:</td>\n        <td width=''99%'' style=''font-weight:normal; line-height:160%;''>The Head Teacher,<br />\n_SCHOOL_NAME_<br />\n_SCHOOL_ADDRESS_</td>\n      </tr>\n    </table></td><td valign=''top''><table border=''0'' cellspacing=''0'' cellpadding=''0'' align=''right''>\n      <tr>\n        <td style=''height:30px; color:#999;''>&nbsp;</td>\n      </tr>\n      <tr>\n        <td style=''font-weight:normal;''>_TRACKING_IMAGE_</td>\n      </tr>\n      <tr>\n        <td style=''font-family:&quot;Courier New&quot;, Courier, monospace; text-align:center;color:#999;''>_TRACKING_NUMBER_<br />\n          <span style=''font-size:9px; font-family:Arial, Helvetica, sans-serif; font-weight:bold;color:#999;''><br />QUOTE TRACKING NUMBER IN <br />FUTURE CORRESPONDENCE.</span></td>\n      </tr>\n    </table></td></tr>\n  </table>\n  \n\n  </td>\n</tr>\n\n\n<tr><td>&nbsp;</td></tr>\n\n\n<tr>\n  <td style=''line-height:160%;''><span style=''font-weight:bold''>RE: CONFIRMATION OF APPOINTMENT</span><br />\n    I am pleased to inform you that the Education Service Commission under Minute No. _MINUTE_NUMBER_, directed that you be confirmed in your appointment as <span style=''font-weight:bold;''>_NEW_POSITION_ at _SCHOOL_NAME_</span> and admitted to the permanent and pensionable establishment of the Public Service with effect from the date of appointment on probation.<br />\n    <br />\n    Your attention is drawn to the Uganda Public Service Standing Orders 2010 Section <span style=''font-weight:bold;''>a-e</span> paragraphs <span style=''font-weight:bold;''>10-13</span> which explain the effect of confirmation.<br />\n    <br />\n    Yours faithfully,</td>\n</tr>\n<tr>\n  <td><br /><img src=''_ASSET_FOLDER_uploads/images/_APPROVER_SIGNATURE_'' border=''0'' style=''height:80px;'' />\n<br /><br />_APPROVER_NAME_\n<br /><span style=''font-weight:bold;''>For: PERMANENT SECRETARY</span></td>\n</tr>\n<tr>\n  <td style=''line-height:160%;''>C.C: The Auditor General, Audit Commission <br />\n    C.C: \n    Permanent Secretary, Ministry of Public Service<br />\n    C.C: Secretary, Education Service Commission<br />\n    C.C: Personal File\n  </td>\n</tr>\n<tr>\n  <td style=''border-top: solid 3px #000;''><table border=''0'' cellspacing=''0'' cellpadding=''0'' width=''100%'' style=''font-weight:bold;''>\n    <tr>\n      <td style=''font-size:9px; font-family:Arial, Helvetica, sans-serif; font-weight:bold; color:#999;''>THIS LETTER HAS AN ELECTRONIC RECORD. MODIFICATION OR FORGERY IS PUNISHABLE BY LAW.</td>\n      <td style=''font-size:9px; font-family:Arial, Helvetica, sans-serif; font-weight:bold; text-align:right;''>FORM: C-530A &nbsp;&nbsp; 01-DEC-2014</td>\n    </tr>\n  </table></td>\n</tr>\n</table>', '', 'Y', '2015-01-24 00:00:00', '1', '2015-01-24 00:00:00', '1'),
(11, 'send_transfer_letter', 'Your Transfer Letter', 'You have been issued a transfer letter for your application which is attached. You can also access it in the TMIS system using your account.\n<br>\n<br>Regards,\n<br>Your TMIS Admin Team\n<br>', 'Your transfer letter has been sent.', 'Y', '2015-01-24 00:00:00', '1', '2015-01-24 00:00:00', '1'),
(12, 'document__transfer_pca', '', 'This is the transfer PCA to be sent to _FIRST_NAME_.', '', 'Y', '2015-01-24 00:00:00', '1', '2015-01-24 00:00:00', '1'),
(13, 'send_transfer_pca', 'Your Transfer PCA', 'You have been issued a transfer PCA for your application which is attached. You can also access it in the TMIS system using your account.\n<br>\n<br>Regards,\n<br>Your TMIS Admin Team\n<br>', 'Your transfer PCA has been sent.', 'Y', '2015-01-24 00:00:00', '1', '2015-01-24 00:00:00', '1'),
(14, 'document__verification_letter', '', '<table width=''100%'' cellpadding=''5'' cellspacing=''0'' style=''font-family: Georgia, &quot;Times New Roman&quot;, Times, serif;''>\r\n<tr><td align=''left'' valign=''top''><table width=''100%'' cellpadding=''5'' cellspacing=''0'' style=''border-bottom: solid 3px #000;''>\r\n  <tr>\r\n    <td valign=''top'' style=''padding-top: 20px; padding-bottom: 0px; text-align:left;''><table border=''0'' cellspacing=''0'' cellpadding=''2'' align=''left'' style=''font-weight:bold;''>\r\n      <tr>\r\n        <td>Telephone:</td>\r\n        <td>0412 34451/4</td>\r\n      </tr>\r\n      <tr>\r\n        <td>Fax:</td>\r\n        <td>0412 234920</td>\r\n      </tr>\r\n      <tr>\r\n        <td>Email:</td>\r\n        <td>pro@education.co.ug</td>\r\n      </tr>\r\n      <tr>\r\n        <td>Website:</td>\r\n        <td>www.education.co.ug</td>\r\n      </tr>\r\n    </table></td>\r\n    <td style=''padding-top: 0px; padding-bottom: 0px; text-align:center;'' nowrap><img src=''_ASSET_FOLDER_images/coat_of_arms.png'' border=''0''/><br /><span  style=''font-family:&quot;Times New Roman&quot;, Times, serif; font-size: 12px; font-weight:bold; text-align:center;''>REPUBLIC OF UGANDA</span></td>\r\n    <td style=''padding-top: 20px; padding-bottom: 10px; text-align:right;''><table border=''0'' cellspacing=''0'' cellpadding=''2'' style=''font-weight:bold;'' align=''right''>\r\n      <tr>\r\n        <td nowrap>Ministry of Education and Sports</td>\r\n        </tr>\r\n      <tr>\r\n        <td>Embassy House</td>\r\n        </tr>\r\n      <tr>\r\n        <td>P.O. Box 7063</td>\r\n        </tr>\r\n      <tr>\r\n        <td>Kampala Uganda</td>\r\n        </tr>\r\n    </table></td>\r\n    </tr>\r\n</table></td></tr>\r\n<tr>\r\n  <td>\r\n  \r\n  <table width=''100%'' cellpadding=''5'' cellspacing=''0''>\r\n  <tr><td><table border=''0'' cellspacing=''0'' cellpadding=''3'' style=''font-weight:bold;''>\r\n      <tr>\r\n        <td colspan=''2'' style=''height:40px; color:#999; vertical-align:top;''>_DATE_TODAY_</td>\r\n        </tr>\r\n      <tr>\r\n        <td colspan=''2'' style=''font-weight:normal;''>_TEACHER_NAME_</td>\r\n        </tr>\r\n      <tr>\r\n        <td colspan=''2'' style=''height:40px; vertical-align:top;''>_JOB_POSITION_</td>\r\n        </tr>\r\n      <tr>\r\n        <td valign=''top'' width=''1%''>Thru:</td>\r\n        <td width=''99%'' style=''font-weight:normal; line-height:160%;''>The Head Teacher,<br />\r\n_SCHOOL_NAME_<br />\r\n_SCHOOL_ADDRESS_</td>\r\n      </tr>\r\n    </table></td><td valign=''top''><table border=''0'' cellspacing=''0'' cellpadding=''0'' align=''right''>\r\n      <tr>\r\n        <td style=''height:30px; color:#999;''>&nbsp;</td>\r\n      </tr>\r\n      <tr>\r\n        <td style=''font-weight:normal;''>_TRACKING_IMAGE_</td>\r\n      </tr>\r\n      <tr>\r\n        <td style=''font-family:&quot;Courier New&quot;, Courier, monospace; text-align:center;color:#999;''>_TRACKING_NUMBER_<br />\r\n          <span style=''font-size:9px; font-family:Arial, Helvetica, sans-serif; font-weight:bold;color:#999;''><br />QUOTE TRACKING NUMBER IN <br />FUTURE CORRESPONDENCE.</span></td>\r\n      </tr>\r\n    </table></td></tr>\r\n  </table>\r\n  \r\n\r\n  </td>\r\n</tr>\r\n\r\n\r\n<tr><td>&nbsp;</td></tr>\r\n\r\n\r\n<tr>\r\n  <td style=''line-height:160%;''><span style=''font-weight:bold''>RE: _LEAVE_TYPE_</span><br />\r\n    This is to inform you that the Education Service Commission under Minute No. _MINUTE_NUMBER_, directed that you be\r\npermitted _LEAVESMALL_TYPE_ from _START_DATE_ to _END_DATE_ for the following reason:\r\n<br>_LEAVE_REASON_\r\n<br /><br />\r\n    You are under obligation in accordance with Uganda Public Service Standing Orders 2010 Section <span style=''font-weight:bold;''>1 (c-d)</span> to return to your institution and resume duties immediately after the completion of your leave.<br />\r\n    <br />\r\n    Yours faithfully,</td>\r\n</tr>\r\n<tr>\r\n  <td><br /><img src=''_ASSET_FOLDER_uploads/images/_APPROVER_SIGNATURE_'' border=''0'' style=''height:80px;'' />\r\n<br /><br />_APPROVER_NAME_\r\n<br /><span style=''font-weight:bold;''>For: PERMANENT SECRETARY</span></td>\r\n</tr>\r\n<tr>\r\n  <td style=''height:60px;''>&nbsp;\r\n  </td>\r\n</tr>\r\n<tr>\r\n  <td style=''border-top: solid 3px #000;''><table border=''0'' cellspacing=''0'' cellpadding=''0'' width=''100%'' style=''font-weight:bold;''>\r\n    <tr>\r\n      <td style=''font-size:9px; font-family:Arial, Helvetica, sans-serif; font-weight:bold; color:#999;''>THIS LETTER HAS AN ELECTRONIC RECORD. MODIFICATION OR FORGERY IS PUNISHABLE BY LAW.</td>\r\n      <td style=''font-size:9px; font-family:Arial, Helvetica, sans-serif; font-weight:bold; text-align:right;''>FORM: C-540A &nbsp;&nbsp; 01-DEC-2014</td>\r\n    </tr>\r\n  </table></td>\r\n</tr>\r\n</table>', '', 'Y', '2015-01-24 00:00:00', '1', '2015-01-24 00:00:00', '1'),
(15, 'send_verification_letter', 'Your Verification Letter', 'You have been issued a verification letter for your application which is attached. You can also access it in the TMIS system using your account.\n<br>\n<br>Regards,\n<br>Your TMIS Admin Team\n<br>', 'Your verification letter has been sent.', 'Y', '2015-01-24 00:00:00', '1', '2015-01-24 00:00:00', '1'),
(16, 'document__retirement_letter', '', '<table width=''100%'' cellpadding=''5'' cellspacing=''0'' style=''font-family: Georgia, &quot;Times New Roman&quot;, Times, serif;''>\r\n<tr><td align=''left'' valign=''top''><table width=''100%'' cellpadding=''5'' cellspacing=''0'' style=''border-bottom: solid 3px #000;''>\r\n  <tr>\r\n    <td valign=''top'' style=''padding-top: 20px; padding-bottom: 0px; text-align:left;''><table border=''0'' cellspacing=''0'' cellpadding=''2'' align=''left'' style=''font-weight:bold;''>\r\n      <tr>\r\n        <td>Telephone:</td>\r\n        <td>0412 34451/4</td>\r\n      </tr>\r\n      <tr>\r\n        <td>Fax:</td>\r\n        <td>0412 234920</td>\r\n      </tr>\r\n      <tr>\r\n        <td>Email:</td>\r\n        <td>pro@education.co.ug</td>\r\n      </tr>\r\n      <tr>\r\n        <td>Website:</td>\r\n        <td>www.education.co.ug</td>\r\n      </tr>\r\n    </table></td>\r\n    <td style=''padding-top: 0px; padding-bottom: 0px; text-align:center;'' nowrap><img src=''_ASSET_FOLDER_images/coat_of_arms.png'' border=''0''/><br /><span  style=''font-family:&quot;Times New Roman&quot;, Times, serif; font-size: 12px; font-weight:bold; text-align:center;''>REPUBLIC OF UGANDA</span></td>\r\n    <td style=''padding-top: 20px; padding-bottom: 10px; text-align:right;''><table border=''0'' cellspacing=''0'' cellpadding=''2'' style=''font-weight:bold;'' align=''right''>\r\n      <tr>\r\n        <td nowrap>Ministry of Education and Sports</td>\r\n        </tr>\r\n      <tr>\r\n        <td>Embassy House</td>\r\n        </tr>\r\n      <tr>\r\n        <td>P.O. Box 7063</td>\r\n        </tr>\r\n      <tr>\r\n        <td>Kampala Uganda</td>\r\n        </tr>\r\n    </table></td>\r\n    </tr>\r\n</table></td></tr>\r\n<tr>\r\n  <td>\r\n  \r\n  <table width=''100%'' cellpadding=''5'' cellspacing=''0''>\r\n  <tr><td><table border=''0'' cellspacing=''0'' cellpadding=''3'' style=''font-weight:bold;''>\r\n      <tr>\r\n        <td colspan=''2'' style=''height:40px; color:#999; vertical-align:top;''>_DATE_TODAY_</td>\r\n        </tr>\r\n      <tr>\r\n        <td colspan=''2'' style=''font-weight:normal; line-height:160%;''>Permanent Secretary\r\n	<br>Ministry of Public Service\r\n	<br>KAMPALA</td>\r\n        </tr>\r\n<tr>\r\n        <td colspan=''2'' style=''font-weight:normal; line-height:160%;''>&nbsp;</td>\r\n        </tr>\r\n        <tr>\r\n        <td colspan=''2'' style=''font-weight:normal; line-height:160%;''>&nbsp;</td>\r\n        </tr>\r\n    </table></td><td valign=''top''><table border=''0'' cellspacing=''0'' cellpadding=''0'' align=''right''>\r\n      <tr>\r\n        <td style=''height:30px; color:#999;''>&nbsp;</td>\r\n      </tr>\r\n      <tr>\r\n        <td style=''font-weight:normal;''>_TRACKING_IMAGE_</td>\r\n      </tr>\r\n      <tr>\r\n        <td style=''font-family:&quot;Courier New&quot;, Courier, monospace; text-align:center;color:#999;''>_TRACKING_NUMBER_<br />\r\n          <span style=''font-size:9px; font-family:Arial, Helvetica, sans-serif; font-weight:bold;color:#999;''><br />QUOTE TRACKING NUMBER IN <br />FUTURE CORRESPONDENCE.</span></td>\r\n      </tr>\r\n    </table></td></tr>\r\n  </table>\r\n  \r\n\r\n  </td>\r\n</tr>\r\n\r\n\r\n<tr><td>&nbsp;</td></tr>\r\n\r\n\r\n<tr>\r\n  <td style=''line-height:160%;padding-top:60px;''><span style=''font-weight:bold''>RETIREMENT BENEFITS: _TEACHER_NAME_ - REG. _FILE_NUMBER_ - _JOB_POSITION_</span><br />\r\n    I am forwarding herewith retirement benefit forms duly completed and verified with all the relevant documents in respect of the above mentioned for your necessary action.\r\n<br><br>Additional information: <br>_RETIREMENT_DETAILS_\r\n    <br />\r\n    <br />\r\n    Yours faithfully,</td>\r\n</tr>\r\n<tr>\r\n  <td><br /><img src=''_ASSET_FOLDER_uploads/images/_APPROVER_SIGNATURE_'' border=''0'' style=''height:80px;'' />\r\n<br /><br />_APPROVER_NAME_\r\n<br /><span style=''font-weight:bold;''>For: PERMANENT SECRETARY</span></td>\r\n</tr>\r\n<tr>\r\n  <td style=''height:60px;''>CC. Personal File\r\n  </td>\r\n</tr>\r\n<tr>\r\n  <td style=''border-top: solid 3px #000;''><table border=''0'' cellspacing=''0'' cellpadding=''0'' width=''100%'' style=''font-weight:bold;''>\r\n    <tr>\r\n      <td style=''font-size:9px; font-family:Arial, Helvetica, sans-serif; font-weight:bold; color:#999;''>THIS LETTER HAS AN ELECTRONIC RECORD. MODIFICATION OR FORGERY IS PUNISHABLE BY LAW.</td>\r\n      <td style=''font-size:9px; font-family:Arial, Helvetica, sans-serif; font-weight:bold; text-align:right;''>FORM: C-550A &nbsp;&nbsp; 01-DEC-2014</td>\r\n    </tr>\r\n  </table></td>\r\n</tr>\r\n</table>', '', 'Y', '2015-01-24 00:00:00', '1', '2015-01-24 00:00:00', '1'),
(17, 'send_retirement_letter', 'Your Retirement Letter', 'You have been issued a retirement letter for your application which is attached.\n<br>\n<br>Regards,\n<br>Your TMIS Admin Team\n<br>', 'Your retirement letter has been sent.', 'Y', '2015-01-24 00:00:00', '1', '2015-01-24 00:00:00', '1'),
(18, 'introduce_new_user', 'Your New Account Details', 'An account has been created for you at the Teacher Management Information System (TMIS). You will need the following details to login:\n<br>\nYour user name: _EMAILADDRESS_\n<br>Your Temporary Password: _PASSWORD_\n<br>\n<br>Use the link below to access the TMIS website:\n<br>_LOGIN_LINK_\n<br>\n<br>Regards,\n<br>Your TMIS Admin Team\n<br>', 'Your TMIS account has been created. Login at _LOGIN_LINK_ with username: _EMAILADDRESS_ and password: _PASSWORD_', 'Y', '2015-01-26 00:00:00', '1', '2015-01-26 00:00:00', '1'),
(19, 'notify_change_of_user_status', 'Your TMIS User Status has Been Changed', 'Your TMIS user status is now _STATUS_.\n<br>\n<br>If you believe this was made in error, please notify us immediately.\n<br>\n<br>\n<br>Regards,\n<br>Your TMIS Admin Team\n<br>', 'Your TMIS user status is now _STATUS_.', 'N', '2015-01-27 00:00:00', '1', '2015-01-27 00:00:00', '1'),
(20, 'reject_user_application', 'Your User Application Has Been Rejected', 'Your TMIS user application has been rejected.\n<br>Reasons given:\n<br>_REASON_\n<br>\n<br>Please re-apply with the reasons fixed at:\n<br>_LOGIN_LINK_\n<br>\n<br>Regards,\n<br>Your TMIS Admin Team\n<br>', 'Your TMIS user application has been rejected. Please see your email for reasons.', 'Y', '2015-01-27 00:00:00', '1', '2015-01-27 00:00:00', '1'),
(21, 'reject_permission_group', 'Your Permission Group Addition Has Been Rejected', 'Your TMIS permission group addition has been rejected.\n<br>Reasons given:\n<br>_REASON_\n<br>\n<br>Please re-add with the reasons fixed at:\n<br>_LOGIN_LINK_\n<br>\n<br>Regards,\n<br>Your TMIS Admin Team\n<br>', 'Your TMIS permission group addition has been rejected. Please see your email for reasons.', 'Y', '2015-01-27 00:00:00', '1', '2015-01-27 00:00:00', '1'),
(22, 'user_defined_message', '_USER_DEFINED_', '_USER_DEFINED_', '_USER_DEFINED_', 'Y', '2015-01-30 00:00:00', '1', '2015-01-30 00:00:00', '1'),
(23, 'notify_change_of_data_status', 'A _ITEM_ status has been changed by _APPROVER_NAME_', 'The status of a _ITEM_ you acted on at TMIS has been changed to _STATUS_ by _APPROVER_NAME_. This action was taken on _ACTION_DATE_. The details of the _ITEM_ are:\n<br>_DETAILS_\n<br>\n<br>Regards,\n<br>Your TMIS Admin Team\n<br>', 'The status of a _ITEM_ you acted on has been changed to _STATUS_ by _APPROVER_NAME_.', 'Y', '2015-01-30 00:00:00', '1', '2015-01-30 00:00:00', '1'),
(24, 'contact_us_message', 'TMIS Message From _USERNAMES_: _SUBJECT_', 'A message was sent by _USERNAMES_ at _SENT_TIME_ from _LOGIN_LINK_ with the following details: <br> <br><b>Your Name:</b> _USERNAMES_ <br><b>Email Address:</b> _USEREMAILADDRESS_ <br><b>Telephone:</b> _TELEPHONE_ <br><b>Reason:</b> _SUBJECT_ <br><b>Message:</b> <br>_DETAILS_ <br> <br>Regards, <br>Your TMIS Admin Team <br>', '', 'Y', '2015-02-02 00:00:00', '1', '2015-02-02 00:00:00', '1'),
(25, 'job_application_sent', 'TMIS Job Application Submitted by _FROM_NAME_', 'A job application has been submitted by _FROM_NAME_. This action was taken on _ACTION_DATE_. The details of the job are:\n<br>Job Title: _JOB_TITLE_\n<br>Role: _JOB_ROLE_\n<br>Institution: _INSTITUTION_\n<br>Summary: _JOB_SUMMARY_\n<br>\n<br>Regards,\n<br>Your TMIS Admin Team\n<br>', 'A job application has been submitted by _FROM_NAME_ at the TMIS website for _JOB_TITLE_.', 'Y', '2015-02-04 00:00:00', '1', '2015-02-04 00:00:00', '1'),
(26, 'notice_of_set_interview', 'An Interview Has Been Set for _APPLICANT_', 'An interview has been set for a job application with _INSTITUTION_NAME_ that you submitted at the TMIS website on _SUBMISSION_DATE_.\n<br>The interview will be carried out on _PLANNED_DATE_ by _INTERVIEWER_.\n<br>\n<br>The interviewer would like you to take note of the following:\n<br>_INTERVIEW_NOTES_\n<br>\n<br>Regards,\n<br>Your TMIS Admin Team\n<br>', 'An interview has been set for _APPLICANT_ for the job at _INSTITUTION_NAME_ to be interviewed by _INTERVIEWER_ on _PLANNED_DATE_.', 'Y', '2015-02-01 00:00:00', '1', '2015-02-01 00:00:00', '1'),
(27, 'notify_interview_status_change', 'Result of the Interview for _APPLICANT_NAME_ Have Been Posted', 'The interview attended by _APPLICANT_NAME_ on _INTERVIEW_DATE_ for the job [_JOB_NAME_] has been posted as _INTERVIEW_RESULT_. This action was carried out on _ACTION_DATE_.\n<br>\n<br>The following note was added regarding this result:\n<br>_INTERVIEW_NOTES_\n<br>\n<br>Regards,\n<br>Your TMIS Admin Team\n<br>', 'The result for the interview attended by _APPLICANT_NAME_ on _INTERVIEW_DATE_ for the job [_JOB_NAME_] has been posted as _INTERVIEW_RESULT_.', 'Y', '2015-02-05 00:00:00', '1', '2015-02-05 00:00:00', '1'),
(28, 'notify_interview_cancellation', 'The Interview With _INTERVIEWER_NAME_ Has Been Cancelled', 'The interview for _APPLICANT_NAME_ for the job [_JOB_NAME_] with _INTERVIEWER_NAME_ which was scheduled for _INTERVIEW_DATE_ has been cancelled. This action was taken on _ACTION_DATE_.\n<br>Reasons given:\n<br>_REASON_\n<br>\n<br>Regards,\n<br>Your TMIS Admin Team\n<br>', 'The interview for the job [_JOB_NAME_] with _INTERVIEWER_NAME_ which was scheduled for _INTERVIEW_DATE_ has been cancelled.', 'Y', '2015-02-05 00:00:00', '1', '2015-02-05 00:00:00', '1'),
(29, 'request_teacher_posting', 'Your Approval is Required to Post a Teacher', 'A teacher with the name _APPLICANT_NAME_ has passed the final interview and has therefore been awarded the post of _JOB_NAME_. This development was posted by _MADE_BY_ on _ACTION_DATE_.\n<br>\n<br>Your approval is required in the TMIS system to post the teacher so that they can begin their probational period of employment at their new job.\n<br>\n<br>Regards,\n<br>Your TMIS Admin Team\n<br>', 'Your approval is required to post a teacher _APPLICANT_NAME_ for the job _JOB_NAME_.', 'Y', '2015-02-06 00:00:00', '1', '2015-02-06 00:00:00', '1'),
(30, 'password_recovery_notification', 'Your Temporary Password for TMIS', 'Your TMIS password has been reset. \n<br>You will need the following details to login:\n<br>\nYour user name: _EMAILADDRESS_\n<br>Your Temporary Password: _PASSWORD_\n<br>For your security, you are encouraged to change this password the first time you login on your profile page.\n<br>\n<br>In case you closed the TMIS website, go to the link below to login:\n<br>_LOGIN_LINK_\n<br>\n<br>If you did not request this password change, please contact us at security@tmis.go.ug\n<br>\n<br>Regards,\n<br>Your TMIS Admin Team\n<br>', 'Your TMIS temporary Password is _PASSWORD_', 'N', '2015-02-07 00:00:00', '1', '2015-02-07 00:00:00', '1'),
(31, 'notify_permission_change', 'Your TMIS Permissions Have Changed', 'Your permission group has been changed to [_NEW_PERMISSION_GROUP_] by _UPDATED_BY_. This action was taken on _ACTION_DATE_. <br> <br>Use the link below to login with your new permissions: <br>_LOGIN_LINK_ <br> <br>If you believe this was done in error, please contact us immediately. <br> <br>Regards, <br>Your TMIS Admin Team <br>', 'Your TMIS permissions have been changed to [_NEW_PERMISSION_GROUP_] by _UPDATED_BY_. ', 'Y', '2015-02-17 00:00:00', '1', '2015-02-17 00:00:00', '1');

DROP TABLE IF EXISTS query;
CREATE TABLE `query` (
  id bigint(20) NOT NULL AUTO_INCREMENT,
  `code` varchar(300) NOT NULL,
  details text NOT NULL,
  PRIMARY KEY (id)
) ENGINE=InnoDB  DEFAULT CHARSET=latin1;

INSERT INTO query (id, code, details) VALUES
(1, 'get_list_of_districts', 'SELECT *, name AS value, name AS display FROM district ORDER BY name'),
(2, 'get_list_of_countries', 'SELECT *, name AS value, name AS display FROM country ORDER BY display_order DESC, name ASC'),
(3, 'add_person_data', 'INSERT INTO person (first_name, last_name, gender, marital_status, date_of_birth, date_added, citizenship_id, citizenship_type) \n\n(SELECT ''_FIRST_NAME_'' AS first_name, ''_LAST_NAME_'' AS last_name, ''_GENDER_'' AS gender, ''_MARITAL_STATUS_'' AS marital_status, ''_DATE_OF_BIRTH_'' AS date_of_birth, NOW() AS date_added, (SELECT id FROM country WHERE name=''_CITIZENSHIP_COUNTRY_'' LIMIT 1) AS citizenship_id, ''_CITIZENSHIP_TYPE_'' AS citizenship_type)'),
(4, 'add_contact_data', 'INSERT INTO contact (contact_type, carrier_id, details, parent_id, parent_type, date_added) VALUES (''_CONTACT_TYPE_'', ''_CARRIER_ID_'', ''_DETAILS_'', ''_PARENT_ID_'', ''_PARENT_TYPE_'', NOW())'),
(5, 'add_new_address', 'INSERT IGNORE INTO address (parent_id, parent_type, address_type, importance, details, county, district_id, country_id, date_added)\n\n(SELECT ''_PARENT_ID_'' AS parent_id, \n''_PARENT_TYPE_'' AS parent_type, \n''_ADDRESS_TYPE_'' AS address_type, \n''_IMPORTANCE_'' AS importance, \n''_DETAILS_'' AS details, \n ''_COUNTY_'' AS county,\nIF((SELECT id FROM district WHERE name=''_DISTRICT_'' LIMIT 1) IS NOT NULL, (SELECT id FROM district WHERE name=''_DISTRICT_'' LIMIT 1), ''_DISTRICT_'') AS district_id, \nIF((SELECT id FROM country WHERE name=''_COUNTRY_'' LIMIT 1) IS NOT NULL, (SELECT id FROM country WHERE name=''_COUNTRY_'' LIMIT 1), ''_COUNTRY_'') AS country_id,\nNOW() AS date_added\n)'),
(6, 'add_user_data', 'INSERT INTO user (person_id, 	login_name, login_password, permission_group_id, status, date_added, last_updated) \r\n\r\n(SELECT ''_PERSON_ID_'' AS person_id, ''_LOGIN_NAME_'' AS login_name, ''_LOGIN_PASSWORD_'' AS login_password, IF(''_PERMISSION_GROUP_''<>'''', (SELECT id FROM permission_group WHERE notes=''_PERMISSION_GROUP_'' LIMIT 1), '''') AS permission_group_id, ''_STATUS_'' AS status, NOW() AS date_added, NOW() AS last_updated)'),
(7, 'get_message_template', 'SELECT * FROM message WHERE message_type=''_MESSAGE_TYPE_'''),
(8, 'add_event_log', 'INSERT INTO log (log_code, result, details, date_added) VALUES (''_LOG_CODE_'', ''_RESULT_'', ''_DETAILS_'', NOW())'),
(9, 'update_person_profile_part', 'UPDATE person SET _QUERY_PART_ WHERE id=''_PERSON_ID_'''),
(10, 'update_person_citizenship', 'UPDATE person P LEFT JOIN country C ON (C.name=''_CITIZEN_COUNTRY_'') \r\nSET P.citizenship_id=C.id, P.citizenship_type=''_CITIZENSHIP_TYPE_'' WHERE P.id=''_PERSON_ID_'''),
(11, 'add_another_id', 'INSERT INTO other_user_id (parent_id, parent_type, id_type, id_value, date_added) \r\nVALUES \r\n(''_PARENT_ID_'', ''_PARENT_TYPE_'', ''_ID_TYPE_'', ''_ID_VALUE_'', NOW())\r\n\r\nON DUPLICATE KEY UPDATE \r\nid_value=VALUES(id_value),\r\ndate_added=VALUES(date_added)'),
(12, 'add_academic_history', 'INSERT IGNORE INTO academic_history (person_id, institution, institution_type, start_date, end_date, certificate_name, certificate_number, is_highest, date_added, added_by) VALUES (''_PERSON_ID_'', ''_INSTITUTION_'', ''_INSTITUTION_TYPE_'', ''_START_DATE_'', ''_END_DATE_'', ''_CERTIFICATE_NAME_'', ''_CERTIFICATE_NUMBER_'', ''_IS_HIGHEST_'', NOW(), ''_ADDED_BY_'')'),
(13, 'add_subject_data', 'INSERT INTO subject (details, study_category, parent_id, parent_type) VALUES (''_DETAILS_'', ''_STUDY_CATEGORY_'', ''_PARENT_ID_'', ''_PARENT_TYPE_'')'),
(14, 'remove_academic_history', 'DELETE FROM academic_history WHERE person_id=''_PERSON_ID_'''),
(15, 'remove_subject_data', 'DELETE FROM subject WHERE parent_id=''_PARENT_ID_'' AND parent_type=''_PARENT_TYPE_'''),
(16, 'update_person_data', 'UPDATE person SET first_name=''_FIRST_NAME_'', last_name=''_LAST_NAME_'', gender=''_GENDER_'', \r\nmarital_status=''_MARITAL_STATUS_'', date_of_birth=''_DATE_OF_BIRTH_'',\r\ncitizenship_id=(SELECT id FROM country WHERE name=''_CITIZENSHIP_COUNTRY_'' LIMIT 1),\r\ncitizenship_type=''_CITIZENSHIP_TYPE_'' \r\n\r\nWHERE id=''_PERSON_ID_'''),
(17, 'update_contact_data', 'UPDATE contact SET details=''_DETAILS_'', carrier_id=''_CARRIER_ID_''  WHERE contact_type=''_CONTACT_TYPE_'' AND parent_id=''_PARENT_ID_'' AND parent_type=''_PARENT_TYPE_'''),
(18, 'update_address_data', 'INSERT INTO address (parent_id, parent_type, address_type, importance, details, county, district_id, country_id, date_added)\r\n\r\n(SELECT ''_PARENT_ID_'' AS parent_id, \r\n''_PARENT_TYPE_'' AS parent_type, \r\n''_ADDRESS_TYPE_'' AS address_type, \r\n''_IMPORTANCE_'' AS importance, \r\n''_DETAILS_'' AS details, \r\n ''_COUNTY_'' AS county,\r\nIF((SELECT id FROM district WHERE name=''_DISTRICT_'' LIMIT 1) IS NOT NULL, (SELECT id FROM district WHERE name=''_DISTRICT_'' LIMIT 1), ''_DISTRICT_'') AS district_id, \r\nIF((SELECT id FROM country WHERE name=''_COUNTRY_'' LIMIT 1) IS NOT NULL, (SELECT id FROM country WHERE name=''_COUNTRY_'' LIMIT 1), ''_COUNTRY_'') AS country_id,\r\nNOW() AS date_added\r\n)\r\n\r\nON DUPLICATE KEY UPDATE\r\n\r\ndetails=VALUES(details), \r\naddress_type=VALUES(address_type),\r\ncounty=VALUES(county),\r\ndistrict_id=VALUES(district_id), \r\ncountry_id=VALUES(country_id)'),
(19, 'update_another_id', 'UPDATE other_user_id SET id_value=''_ID_VALUE_'' WHERE parent_id=''_PARENT_ID_'' AND parent_type=''_PARENT_TYPE_'' AND id_type=''_ID_TYPE_'''),
(20, 'record_message_exchange', 'INSERT INTO message_exchange (message_id, send_format, details, subject, attachment, date_added, sender, recipient_id)\r\n\r\n(SELECT M.id AS message_id, ''_SEND_FORMAT_'' AS send_format, ''_DETAILS_'' AS details, ''_SUBJECT_'' AS subject, ''_ATTACHMENT_'' AS attachment, NOW() AS date_added, ''_SENDER_'' AS sender, U.id AS recipient_id FROM message M LEFT JOIN user U ON (U.id IN (''_RECIPIENT_ID_'')) WHERE M.message_type=''_CODE_'')'),
(21, 'get_user_by_name_and_pass', 'SELECT U.*, P.first_name, P.last_name, P.gender, P.date_of_birth, P.signature, P.photo, PS.institution_id AS user_posting, PG.notes AS permission_group_name,\n\n(SELECT P.code FROM permission_group G LEFT JOIN permission P ON (G.default_permission=P.id) WHERE G.id=U.permission_group_id LIMIT 1) AS default_permission_code,\n\n(SELECT details FROM contact WHERE contact_type=''email'' AND parent_id=P.id AND parent_type=''person'' AND status=''active'' LIMIT 1) AS email_address,\n\nIF((SELECT details FROM contact WHERE contact_type=''telephone'' AND parent_id=P.id AND parent_type=''person'' AND status=''active'' LIMIT 1) IS NOT NULL, (SELECT details FROM contact WHERE contact_type=''telephone'' AND parent_id=P.id AND parent_type=''person'' AND status=''active'' LIMIT 1), '''') AS telephone \n\nFROM user U \nLEFT JOIN person P ON (U.person_id=P.id) \nLEFT JOIN permission_group PG ON (U.permission_group_id=PG.id) \nLEFT JOIN posting PS ON (PS.postee_id=U.id)\nWHERE login_name=''_LOGIN_NAME_'' AND login_password=''_LOGIN_PASSWORD_'' AND U.status=''active'''),
(22, 'get_user_by_email', 'SELECT U.id AS user_id, P.first_name, P.last_name \r\nFROM contact C LEFT JOIN person P ON (C.parent_id=P.id AND C.contact_type=''email'' AND C.parent_type=''person'') LEFT JOIN user U ON (U.person_id=P.id) \r\nWHERE C.details=''_EMAIL_ADDRESS_'''),
(23, 'get_group_permissions', 'SELECT P.code \r\nFROM permission_group_mapping M LEFT JOIN permission P ON (M.permission_id=P.id) \r\nWHERE M.group_id=''_GROUP_ID_'''),
(24, 'activate_teacher_applicant_user', 'UPDATE user SET status=''active'', last_updated=NOW(), permission_group_id=(SELECT id FROM permission_group WHERE name=''applicant'' LIMIT 1) WHERE person_id=''_PERSON_ID_'' AND permission_group_id='''''),
(25, 'get_user_by_id', 'SELECT *, id AS user_id FROM user WHERE id=''_USER_ID_'''),
(26, 'get_group_by_id', 'SELECT * FROM permission_group WHERE id=''_GROUP_ID_'''),
(27, 'get_group_default_permission', 'SELECT P.code, P.url AS page FROM permission_group G LEFT JOIN permission P ON (G.default_permission=P.id) WHERE G.id = ''_GROUP_ID_'' LIMIT 1'),
(28, 'get_permission_by_code', 'SELECT * FROM permission WHERE code=''_CODE_'''),
(29, 'get_permission_details', 'SELECT * FROM permission WHERE code IN (_PERMISSIONS_) AND status=''active'''),
(30, 'get_user_profile', 'SELECT U.id AS user_id, U.person_id, U.login_name, U.date_added, P.first_name, P.last_name, P.signature, P.photo,  \n\n(SELECT notes FROM permission_group WHERE id=U.permission_group_id LIMIT 1) AS user_role, \n \n(SELECT details FROM contact WHERE parent_id=U.person_id AND parent_type=''person'' AND contact_type=''email'' AND status=''active'' LIMIT 1) AS email_address, \n\n(SELECT details FROM contact WHERE parent_id=U.person_id AND parent_type=''person'' AND contact_type=''telephone'' AND status=''active'' LIMIT 1) AS telephone \n\nFROM user U LEFT JOIN person P ON (P.id=U.person_id) \nWHERE U.id=''_USER_ID_'''),
(31, 'update_user_password', 'UPDATE user SET login_password=''_NEW_PASSWORD_'', previous_password=''_OLD_PASSWORD_'', last_updated=NOW(), last_updated_by=''_UPDATED_BY_'' WHERE id=''_USER_ID_'''),
(32, 'get_list_of_institutions', 'SELECT *, name AS value, name AS display FROM institution WHERE _SEARCH_QUERY_ ORDER BY name LIMIT 100'),
(33, 'get_permission_groups', 'SELECT *, notes AS value, notes AS display FROM permission_group WHERE is_system_only IN (_SYSTEM_ONLY_) AND name NOT IN (''applicant'',''teacher'') ORDER BY notes'),
(34, 'add_vacancy_data', 'INSERT INTO vacancy (school_id, start_date, end_date, topic, summary, details, role_id, date_added, added_by, last_updated, last_updated_by)\r\n\r\n(SELECT \r\n(SELECT id FROM institution WHERE name=''_INSTITUTION_'' LIMIT 1) AS school_id, \r\n\r\n''_START_DATE_'' AS start_date, ''_END_DATE_'' AS end_date, ''_TOPIC_'' AS topic, ''_SUMMARY_'' AS summary, ''_DETAILS_'', \r\n\r\n(SELECT id FROM duty WHERE name=''_ROLE_'' LIMIT 1) AS role_id, \r\n\r\nNOW() AS date_added, ''_ADDED_BY_'' AS added_by, NOW() AS last_updated, ''_ADDED_BY_'' AS last_updated_by\r\n)'),
(35, 'update_vacancy_data', 'UPDATE vacancy SET topic=''_TOPIC_'', summary=''_SUMMARY_'', details=''_DETAILS_'', start_date=''_START_DATE_'', end_date=''_END_DATE_'', last_updated=NOW(), last_updated_by=''_UPDATED_BY_'' WHERE id=''_VACANCY_ID_'''),
(36, 'get_vacancy_list_data', 'SELECT V.id, V.start_date, V.end_date, V.topic, V.summary, V.status, I.name AS institution_name, D.name AS role_name \r\nFROM vacancy V LEFT JOIN institution I ON (V.school_id=I.id) LEFT JOIN duty D ON (V.role_id=D.id) \r\nWHERE _SEARCH_QUERY_ ORDER BY _ORDER_BY_ LIMIT _LIMIT_TEXT_;'),
(37, 'get_vacancy_by_id', 'SELECT V.*, I.name AS institution_name, D.name AS role_name \nFROM vacancy V LEFT JOIN institution I ON (V.school_id=I.id) LEFT JOIN duty D ON (V.role_id=D.id) \nWHERE V.id=''_VACANCY_ID_'';'),
(38, 'add_approval_chain', 'INSERT INTO approval_chain (chain_type, step_number, subject_id, originator_id, approver_id, actual_approver, status, date_created, max_steps) \r\n\r\n(SELECT ''_CHAIN_TYPE_'' AS chain_type, ''_STEP_NUMBER_'' AS step_number, ''_SUBJECT_ID_'' AS subject_id, ''_ORIGINATOR_ID_'' AS originator_id, ''_APPROVER_ID_'' AS approver_id, ''_ACTUAL_APPROVER_'' AS actual_approver, ''_STATUS_'' AS status, NOW() AS date_created, S.max_steps AS max_steps FROM approval_chain_setting S WHERE S.chain_type=''_CHAIN_TYPE_'' AND S.step_number=''_STEP_NUMBER_'' LIMIT 1)'),
(39, 'get_approval_chain_setting', 'SELECT * FROM approval_chain_setting WHERE chain_type=''_CHAIN_TYPE_'' AND step_number=''_STEP_NUMBER_'''),
(40, 'get_approval_chain_by_id', 'SELECT C.*, \r\n(SELECT CONCAT(P1.first_name, '' '', P1.last_name) FROM approval_chain C1 LEFT JOIN user U1 ON (C1.step_number =''1'' AND C1.actual_approver = U1.id) LEFT JOIN person P1 ON (P1.id=U1.person_id) WHERE  C1.subject_id=C.subject_id AND C1.chain_type=C.chain_type LIMIT 1) AS originator_name, \r\n\r\nIF(C.actual_approver <> '''', (SELECT CONCAT(P2.first_name, '' '', P2.last_name) FROM user U2 LEFT JOIN person P2 ON (P2.id=U2.person_id) WHERE U2.id=C.actual_approver LIMIT 1), '''') AS approver_name \r\n\r\nFROM approval_chain C WHERE C.id=''_CHAIN_ID_'''),
(41, 'get_parties_in_chain', 'SELECT DISTINCT actual_approver	FROM approval_chain WHERE subject_id=''_SUBJECT_ID_'' AND chain_type=''_CHAIN_TYPE_'' AND status=''approved'''),
(42, 'get_originator_of_chain', 'SELECT actual_approver AS originator FROM approval_chain WHERE subject_id=''_SUBJECT_ID_'' AND step_number=''1'' AND chain_type=''_CHAIN_TYPE_'''),
(43, 'update_vacancy_status', 'UPDATE vacancy SET status=''_STATUS_'', last_updated=NOW(),last_updated_by=''_UPDATED_BY_'' WHERE id=''_VACANCY_ID_'''),
(44, 'deactivate_user_profile', 'UPDATE user SET status=''archived'' WHERE id=''_USER_ID_'''),
(45, 'update_profile_visibility', 'UPDATE person SET is_visible=''_IS_VISIBLE_'' WHERE id=''_PERSON_ID_'''),
(46, 'activate_teacher_data', 'UPDATE user SET \r\n\r\npermission_group_id = (SELECT id FROM permission_group WHERE name=''teacher'' LIMIT 1), \r\nstatus=''active'', \r\nlast_updated=NOW(), last_updated_by=''_UPDATED_BY_'' \r\n\r\nWHERE id IN (_ID_LIST_)'),
(47, 'get_approver_scope', 'SELECT * FROM approval_chain_scope WHERE approver IN (_GROUP_LIST_)'),
(48, 'get_users_in_group', 'SELECT U.id, U.id AS user_id \r\nFROM user U \r\nLEFT JOIN permission_group G ON (G.id=U.permission_group_id) \r\nLEFT JOIN posting PT ON (U.id=PT.postee_id AND PT.status=''confirmed'' AND (posting_end_date=''0000-00-00'' OR posting_end_date > NOW())) \r\nLEFT JOIN institution I ON (PT.institution_id=I.id)\r\nLEFT JOIN address A ON (A.parent_type=''institution'' AND A.parent_id=I.id AND A.status IN (''active'',''verified''))\r\n\r\nWHERE G.name=''_GROUP_'' _CONDITION_'),
(49, 'get_originator_scope', 'SELECT U.id AS originator_id,\n\n(SELECT GROUP_CONCAT(PT.institution_id) FROM posting PT WHERE U.id=PT.postee_id AND PT.status IN (''pending'',''confirmed'',''verified'') AND PT.posting_end_date=''0000-00-00'') AS institutions,\n\n(SELECT IF(A.county <> '''' AND A.county IS NOT NULL, GROUP_CONCAT(A.county), IF(A.district_id <>'''', (SELECT GROUP_CONCAT(C.name) FROM county C WHERE C.district_id=A.district_id), '''')) \nFROM posting PT \nLEFT JOIN address A ON (A.parent_type=''institution'' AND A.parent_id=PT.institution_id AND A.status IN (''active'',''verified'')) WHERE U.id=PT.postee_id AND PT.status IN (''pending'',''confirmed'',''verified'') AND PT.posting_end_date=''0000-00-00'') AS counties,\n\n(SELECT GROUP_CONCAT(A.district_id) FROM posting PT \nLEFT JOIN address A ON (A.parent_type=''institution'' AND A.parent_id=PT.institution_id AND A.status IN (''active'',''verified'')) WHERE U.id=PT.postee_id AND PT.status IN (''pending'',''confirmed'',''verified'') AND PT.posting_end_date=''0000-00-00'') AS districts\n \nFROM user U \nWHERE U.id=''_ORIGINATOR_ID_'''),
(50, 'get_carrier_email_domain', 'SELECT IF(mms_email_domain <>'''', mms_email_domain, sms_email_domain) AS email_domain FROM carrier WHERE number_stubs LIKE ''_NUMBER_STUB_'' OR number_stubs LIKE ''_NUMBER_STUB_,%'' OR number_stubs LIKE ''%,_NUMBER_STUB_,%'' OR number_stubs LIKE ''%,_NUMBER_STUB_'''),
(51, 'get_step_chain', 'SELECT * FROM approval_chain WHERE chain_type=''_CHAIN_TYPE_'' AND step_number=''_STEP_NUMBER_'' AND subject_id=''_SUBJECT_ID_'''),
(52, 'get_user_list_data', 'SELECT U.*, P.first_name, P.last_name, CONCAT(P.last_name, '' '', P.first_name) AS display, CONCAT(P.last_name, '' '', P.first_name) AS value,\n\n(SELECT notes FROM permission_group WHERE id=U.permission_group_id LIMIT 1) AS user_role, \n \n(SELECT details FROM contact WHERE parent_id=U.person_id AND parent_type=''person'' AND contact_type=''email'' AND status=''active'' LIMIT 1) AS email_address, \n\n(SELECT details FROM contact WHERE parent_id=U.person_id AND parent_type=''person'' AND contact_type=''telephone'' AND status=''active'' LIMIT 1) AS telephone \n\nFROM user U \nJOIN person P ON (P.id=U.person_id) \nLEFT JOIN posting PS ON (PS.postee_id=U.id AND PS.posting_end_date=''0000-00-00'' AND PS.status=''verified'')\nWHERE _SEARCH_QUERY_ _ORDER_BY_ LIMIT _LIMIT_TEXT_'),
(53, 'update_user_status', 'UPDATE user SET status=''_STATUS_'', last_updated_by=''_UPDATED_BY_'', last_updated=NOW() WHERE id=''_USER_ID_'''),
(54, 'delete_user_data', 'DELETE U, P, A, C, M, S  \nFROM user U \nJOIN person P ON (U.person_id=P.id) \nLEFT JOIN address A ON (A.parent_type=''person'' AND A.parent_id=P.id) \nLEFT JOIN contact C ON (C.parent_type=''person'' AND C.parent_id=P.id) \nLEFT JOIN message_exchange M ON (M.recipient_id=U.id)\nLEFT JOIN message_status S ON (M.id=S.message_exchange_id) \n\nWHERE U.id=''_USER_ID_'''),
(55, 'update_user_permission_group', 'UPDATE user SET permission_group_id=(SELECT id  FROM permission_group WHERE notes=''_PERMISSION_GROUP_'' LIMIT 1), last_updated_by=''_UPDATED_BY_'', last_updated=NOW() WHERE id=''_USER_ID_'''),
(56, 'get_permission_list', 'SELECT *, display AS permission FROM permission WHERE _SEARCH_QUERY_ _ORDER_BY_ LIMIT _LIMIT_TEXT_'),
(57, 'get_permission_group_list', 'SELECT G.*, P.display, \r\nIF(G.is_system_only=''Y'', ''YES'', ''NO'') AS for_system, IF(last_updated <> ''0000-00-00 00:00:00'', last_updated, '''') AS last_update_date, \r\nIF(G.last_updated_by <> '''', (SELECT CONCAT(P.last_name,'' '',P.first_name) FROM user U LEFT JOIN person P ON (U.person_id=P.id) WHERE U.id=G.last_updated_by LIMIT 1), '''') AS last_updated_user\r\n\r\nFROM permission_group G LEFT JOIN permission P ON (P.id=G.default_permission) WHERE _SEARCH_QUERY_ _ORDER_BY_ LIMIT _LIMIT_TEXT_'),
(58, 'get_user_permission_list', 'SELECT CONCAT(P.last_name, '' '', P.first_name) AS user_name, G.id AS group_id, G.notes AS group_name, PM.display AS default_permission, IF(G.last_updated <> ''0000-00-00 00:00:00'', G.last_updated, '''') AS last_update_date \r\n\r\nFROM user U \r\nLEFT JOIN person P ON (U.person_id = P.id) \r\nLEFT JOIN permission_group G ON (G.id = U.permission_group_id) \r\nLEFT JOIN permission PM ON (G.default_permission = PM.id)\r\nWHERE U.status=''active'' AND _SEARCH_QUERY_ _ORDER_BY_ LIMIT _LIMIT_TEXT_'),
(59, 'get_group_permission_list', 'SELECT M.permission_id, P.category, P.display FROM permission_group_mapping M LEFT JOIN permission P ON (M.permission_id=P.id) WHERE M.group_id=''_GROUP_ID_'' ORDER BY P.category ASC '),
(60, 'add_permission_group', 'INSERT INTO permission_group (name, notes, default_permission, is_removable, is_system_only, date_added, added_by) VALUES (''_NAME_CODE_'', ''_GROUP_NAME_'', ''_DEFAULT_PERMISSION_'', ''Y'', ''_IS_SYSTEM_ONLY_'', NOW(), ''_ADDED_BY_'')'),
(61, 'add_group_permissions', 'INSERT INTO permission_group_mapping (group_id, permission_id, date_added, added_by) \r\n(SELECT ''_GROUP_ID_'' AS group_id, P.id AS permission_id, NOW() AS date_added, ''_ADDED_BY_'' AS added_by FROM permission P WHERE P.id IN (_PERMISSION_IDS_))'),
(62, 'remove_group_permissions', 'DELETE FROM permission_group_mapping WHERE group_id=''_GROUP_ID_'''),
(63, 'update_permission_group', 'UPDATE permission_group SET default_permission=''_DEFAULT_PERMISSION_'', last_updated=NOW(), last_updated_by=''_UPDATED_BY_'' WHERE id=''_GROUP_ID_'''),
(64, 'delete_permission_group_data', 'DELETE G, M FROM permission_group G LEFT JOIN permission_group_mapping M ON ( M.group_id = G.id ) WHERE G.id=''_GROUP_ID_'''),
(65, 'get_active_users', 'SELECT * FROM user WHERE status=''active'''),
(66, 'get_user_names_by_list', 'SELECT CONCAT(P.last_name,'' '', P.first_name) AS name FROM user U LEFT JOIN person P ON (U.person_id=P.id) WHERE U.id IN (_USER_IDS_) _LIMIT_FULL_TEXT_'),
(67, 'get_message_list', 'SELECT M.*, \r\nCONCAT(P.last_name, '' '', P.first_name) AS name,\r\n\r\nIF((SELECT status FROM message_status WHERE message_exchange_id=M.id AND user_id=M.recipient_id ORDER BY date_added DESC LIMIT 1) IS NOT NULL, (SELECT status FROM message_status WHERE message_exchange_id=M.id AND user_id=M.recipient_id ORDER BY date_added DESC LIMIT 1), ''received'') AS status,\r\n\r\nM.date_added AS date_sent \r\n\r\nFROM message_exchange M \r\nLEFT JOIN contact C ON (C.contact_type=''email'' AND C.details=M.sender AND C.parent_type=''person'') \r\nLEFT JOIN person P ON (C.parent_id=P.id)\r\n\r\nWHERE M.recipient_id=''_RECIPIENT_ID_'' _SEARCH_QUERY_ _ORDER_BY_ LIMIT _LIMIT_TEXT_'),
(68, 'get_sent_message_list', 'SELECT M.*, \r\nCONCAT(P.last_name, '' '', P.first_name) AS name,\r\n\r\nIF((SELECT status FROM message_status WHERE message_exchange_id=M.id AND user_id=M.recipient_id ORDER BY date_added DESC LIMIT 1) IS NOT NULL, (SELECT status FROM message_status WHERE message_exchange_id=M.id AND user_id=M.recipient_id ORDER BY date_added DESC LIMIT 1), ''received'') AS status,\r\n\r\nM.date_added AS date_sent \r\n\r\nFROM message_exchange M \r\nLEFT JOIN user U ON (U.id=M.recipient_id)\r\nLEFT JOIN person P ON (U.person_id=P.id) \r\n\r\nWHERE M.sender=''_SENDER_EMAIL_'' _SEARCH_QUERY_ _ORDER_BY_ LIMIT _LIMIT_TEXT_'),
(69, 'add_message_status', 'INSERT INTO message_status \r\n(message_exchange_id, user_id, status, date_added) VALUES \r\n(''_MESSAGE_EXCHANGE_ID_'', ''_USER_ID_'', ''_STATUS_'', NOW()) ON DUPLICATE KEY UPDATE date_added=VALUES(date_added)'),
(70, 'get_message_by_id', 'SELECT M.*, \r\nCONCAT(P.last_name, '' '', P.first_name) AS sender_name,\r\n\r\n(SELECT CONCAT(P1.last_name,'' '', P1.first_name) FROM user U1 LEFT JOIN person P1 ON (U1.person_id=P1.id) WHERE U1.id=M.recipient_id) AS recipient_name,\r\n\r\nIF((SELECT status FROM message_status WHERE message_exchange_id=M.id ORDER BY date_added DESC LIMIT 1) IS NOT NULL, (SELECT status FROM message_status WHERE message_exchange_id=M.id ORDER BY date_added DESC LIMIT 1), ''received'') AS status,\r\n\r\nM.date_added AS date_sent,\r\nU.id AS sender_id\r\n\r\nFROM message_exchange M \r\nLEFT JOIN contact C ON (C.contact_type=''email'' AND C.details=M.sender AND C.parent_type=''person'') \r\nLEFT JOIN person P ON (C.parent_id=P.id)\r\nLEFT JOIN user U ON (U.person_id=C.parent_id AND U.login_name=M.sender)\r\n\r\nWHERE M.id=''_MESSAGE_ID_'''),
(71, 'activate_school_data', 'UPDATE institution SET status=''verified'', last_updated=NOW(), last_updated_by=''_UPDATED_BY_'' WHERE id IN (_ID_LIST_)'),
(72, 'activate_census_data', 'UPDATE census SET \r\nstatus=''active'', \r\nlast_updated=NOW(), last_updated_by=''_UPDATED_BY_'' \r\nWHERE id IN (_ID_LIST_)'),
(73, 'get_school_by_id', 'SELECT S.*, \r\nS.start_date AS date_registered, \r\nA.details AS addressline, \r\nA.county AS county,\r\n\r\nIF((SELECT name FROM district WHERE id=A.district_id LIMIT 1) IS NOT NULL, (SELECT name FROM district WHERE id=A.district_id LIMIT 1), A.district_id) AS district,\r\n\r\nIF((SELECT name FROM country WHERE id=A.country_id LIMIT 1) IS NOT NULL, (SELECT name FROM country WHERE id=A.country_id LIMIT 1), A.country_id) AS country,\r\n\r\nC1.details AS email_address, \r\nC2.details AS telephone\r\n\r\nFROM institution S \r\nLEFT JOIN address A ON (A.parent_id=S.id AND A.parent_type=''school'' AND A.is_primary=''Y'') \r\nLEFT JOIN contact C1 ON (C1.parent_id=S.id AND C1.parent_type=''school'' AND C1.is_primary=''Y'' AND C1.contact_type=''email'') \r\nLEFT JOIN contact C2 ON (C2.parent_id=S.id AND C2.parent_type=''school'' AND C2.is_primary=''Y'' AND C2.contact_type=''telephone'') \r\nWHERE S.id=''_SCHOOL_ID_'''),
(74, 'get_school_list_data', 'SELECT S.*, \nS.start_date AS date_registered, \nA.details AS addressline, \nA.county AS county,\n\nIF((SELECT name FROM district WHERE id=A.district_id LIMIT 1) IS NOT NULL, (SELECT name FROM district WHERE id=A.district_id LIMIT 1), A.district_id) AS district,\n\nIF((SELECT name FROM country WHERE id=A.country_id LIMIT 1) IS NOT NULL, (SELECT name FROM country WHERE id=A.country_id LIMIT 1), A.country_id) AS country,\n\n(SELECT C1.details FROM contact C1 WHERE C1.parent_id = S.id AND C1.parent_type = ''school'' AND C1.is_primary = ''Y'' AND C1.contact_type = ''email'' LIMIT 1) AS email_address,\n\n(SELECT C2.details FROM contact C2 WHERE C2.parent_id = S.id AND C2.parent_type = ''school'' AND C2.is_primary = ''Y'' AND C2.contact_type = ''telephone'' LIMIT 1) AS telephone\n\nFROM institution S \nJOIN address A ON (A.parent_id=S.id AND A.parent_type=''school'' AND A.is_primary=''Y'')  \nWHERE _SEARCH_QUERY_ ORDER BY _ORDER_BY_ LIMIT _LIMIT_TEXT_'),
(75, 'add_school_data', 'INSERT INTO institution (name, start_date, end_date, school_type, date_added, added_by, last_updated, last_updated_by) VALUES (''_NAME_'', ''_START_DATE_'', ''0000-00-00'', ''_SCHOOL_TYPE_'', NOW(), ''_ADDED_BY_'', NOW(), ''_ADDED_BY_'')'),
(76, 'update_item_status', 'UPDATE _TABLE_NAME_ SET status=''_STATUS_'', last_updated_by=''_UPDATED_BY_'', last_updated=NOW() WHERE id=''_ITEM_ID_'''),
(77, 'delete_school_data', 'DELETE S, A, C FROM institution S LEFT JOIN address A ON (A.parent_id=S.id AND A.parent_type=''school'') LEFT JOIN contact C ON (C.parent_id=S.id AND C.parent_type=''school'') WHERE S.id=''_SCHOOL_ID_'' '),
(78, 'get_responsibility_list', 'SELECT *, notes AS responsibility FROM responsibility ORDER BY notes ASC'),
(79, 'get_training_list', 'SELECT *, notes AS training FROM training ORDER BY type ASC, notes ASC'),
(80, 'get_census_list', 'SELECT C.*, CONCAT(P.last_name, '' '', P.first_name) AS teacher_name FROM census C LEFT JOIN user U ON (U.id=C.teacher_id) LEFT JOIN person P ON (P.id=U.person_id) \r\nWHERE _SEARCH_QUERY_ ORDER BY _ORDER_BY_ LIMIT _LIMIT_TEXT_'),
(81, 'add_census_data', 'INSERT INTO census (teacher_id, start_date, end_date, weekly_workload_average, added_by, date_added) VALUES (''_TEACHER_ID_'', ''_START_DATE_'', ''_END_DATE_'', ''_WEEKLY_WORKLOAD_AVERAGE_'', ''_ADDED_BY_'', NOW())'),
(82, 'add_census_responsibility', 'INSERT INTO census_responsibility (census_id, responsibility_id) \r\n(SELECT ''_CENSUS_ID_'' AS census_id, R.id AS responsibility_id FROM responsibility R WHERE R.id IN (_RESPONSIBILITY_IDS_))'),
(83, 'add_census_training', 'INSERT INTO census_training (census_id, training_id) \r\n(SELECT ''_CENSUS_ID_'' AS census_id, T.id AS training_id FROM training T WHERE T.id IN (_TRAINING_IDS_))'),
(84, 'remove_census_responsibility', 'DELETE FROM census_responsibility WHERE census_id=''_CENSUS_ID_'''),
(85, 'remove_census_training', 'DELETE FROM census_training WHERE census_id=''_CENSUS_ID_'''),
(86, 'get_census_responsibility_list', 'SELECT responsibility_id FROM census_responsibility WHERE census_id=''_CENSUS_ID_'''),
(87, 'get_census_training_list', 'SELECT training_id FROM census_training WHERE census_id=''_CENSUS_ID_'''),
(88, 'delete_census_data', 'DELETE C, R, T FROM \r\ncensus C \r\nLEFT JOIN census_responsibility R ON (R.census_id=C.id) \r\nLEFT JOIN census_training T ON (T.census_id=C.id) \r\nWHERE C.id = ''_CENSUS_ID_'''),
(89, 'get_census_training', 'SELECT C.*, T.code, T.notes AS training, T.type FROM census_training C LEFT JOIN training T ON (C.training_id=T.id) WHERE C.census_id=''_CENSUS_ID_'''),
(90, 'get_census_responsibility', 'SELECT C.*, R.code, R.notes AS responsibility FROM census_responsibility C LEFT JOIN responsibility R ON (C.responsibility_id=R.id) WHERE C.census_id=''_CENSUS_ID_'''),
(91, 'update_teacher_status', 'UPDATE user SET teacher_status=''_STATUS_'', last_updated=NOW(), last_updated_by=''_UPDATED_BY_'' WHERE id=''_USER_ID_'''),
(92, 'get_teacher_list_data', 'SELECT U.*, P.first_name, P.last_name, CONCAT(P.last_name, '' '', P.first_name) AS name, \r\n\r\n(SELECT I.name FROM posting P LEFT JOIN institution I ON (P.institution_id=I.id) WHERE P.postee_id=U.id ORDER BY P.posting_start_date DESC LIMIT 1) AS school,\r\n\r\n(SELECT CONCAT(A.details, '' '', A.county, '' '', (SELECT name FROM district WHERE id=A.district_id LIMIT 1), '', '', (SELECT name FROM country WHERE id=A.country_id LIMIT 1)) FROM posting P LEFT JOIN institution I ON (P.institution_id=I.id) LEFT JOIN address A ON (A.parent_id=I.id AND A.parent_type=''school'') WHERE P.postee_id=U.id ORDER BY P.posting_start_date DESC LIMIT 1) AS school_address, \r\n \r\n(SELECT details FROM contact WHERE parent_id=U.person_id AND parent_type=''person'' AND contact_type=''email'' AND is_primary=''Y'' LIMIT 1) AS email_address, \r\n\r\n(SELECT details FROM contact WHERE parent_id=U.person_id AND parent_type=''person'' AND contact_type=''telephone'' AND is_primary=''Y'' LIMIT 1) AS telephone \r\n\r\nFROM user U LEFT JOIN person P ON (P.id=U.person_id) WHERE (U.permission_group_id=''2'' OR U.permission_group_id = ''1'') AND _SEARCH_QUERY_ _ORDER_BY_ LIMIT _LIMIT_TEXT_'),
(93, 'get_teacher_education', 'SELECT id AS education_id, institution_type AS institution__institutiontype, institution AS institutionname, certificate_name AS certificatename, MONTHNAME(start_date) AS from__month, YEAR(start_date) AS from__pastyear, MONTHNAME(end_date) AS to__month, YEAR(end_date) AS to__pastyear, certificate_number AS certificatenumber, is_highest AS highestcertificate FROM academic_history WHERE person_id=''_PERSON_ID_'''),
(94, 'get_teacher_subjects', 'SELECT id AS subject_id, details AS subjectname, study_category AS subject__subjecttype  FROM subject WHERE parent_id=''_PERSON_ID_'' AND parent_type=''person'''),
(95, 'get_teacher_profile', 'SELECT U.id AS teacher_id, U.person_id, P.first_name, P.last_name, CONCAT(P.last_name, '' '', P.first_name) AS name, \r\n\r\n(SELECT details FROM contact WHERE parent_id=U.person_id AND parent_type=''person'' AND contact_type=''telephone'' AND \r\n\r\nis_primary=''Y'' LIMIT 1) AS telephone, \r\n\r\n(SELECT details FROM contact WHERE parent_id=U.person_id AND parent_type=''person'' AND contact_type=''email'' AND is_primary=''Y'' LIMIT 1) AS email_address, \r\n\r\nP.gender, P.marital_status, P.date_of_birth, P.photo, \r\n\r\nA1.details AS birthplace__addressline, \r\nA1.county AS birthplace__county, \r\n(SELECT name FROM district WHERE id=A1.district_id LIMIT 1) AS birthplace__district, \r\n(SELECT name FROM country WHERE id=A1.country_id LIMIT 1) AS birthplace__country, \r\nA1.address_type AS birthplace__addresstype, \r\n\r\n(SELECT id_value FROM other_user_id WHERE parent_id=U.person_id AND parent_type=''person'' AND id_type=''teacher_id'' LIMIT 1) AS teacher_id,\r\n\r\nA2.details AS permanentaddress__addressline, \r\nA2.county AS permanentaddress__county, \r\n(SELECT name FROM district WHERE id=A2.district_id LIMIT 1) AS permanentaddress__district, \r\n(SELECT name FROM country WHERE id=A2.country_id LIMIT 1) AS permanentaddress__country, \r\nA2.address_type AS permanentaddress__addresstype, \r\n\r\nA3.details AS contactaddress__addressline, \r\nA3.county AS contactaddress__county, \r\n(SELECT name FROM district WHERE id=A3.district_id LIMIT 1) AS contactaddress__district, \r\n(SELECT name FROM country WHERE id=A3.country_id LIMIT 1) AS contactaddress__country, \r\nA3.address_type AS contactaddress__addresstype, \r\n\r\n(SELECT name FROM country WHERE id=P.citizenship_id LIMIT 1) AS citizenship__country,\r\nP.citizenship_type AS citizenship__type\r\n\r\nFROM user U \r\nLEFT JOIN person P ON (P.id=U.person_id) \r\nLEFT JOIN address A1 ON (A1.parent_id=U.person_id AND A1.parent_type=''person'' AND A1.importance=''birthplace'')\r\nLEFT JOIN address A2 ON (A2.parent_id=U.person_id AND A2.parent_type=''person'' AND A2.importance=''permanent'')\r\nLEFT JOIN address A3 ON (A3.parent_id=U.person_id AND A3.parent_type=''person'' AND A3.importance=''contact'')\r\n\r\nWHERE U.id=''_TEACHER_ID_'''),
(96, 'get_teacher_grades', 'SELECT name AS value, name AS display FROM grade ORDER BY number'),
(97, 'get_grade_details_by_name', 'SELECT * FROM grade WHERE name=''_GRADE_NAME_'''),
(98, 'add_job_application', 'INSERT IGNORE INTO application (vacancy_id, status, user_id, date_added, added_by, 	last_updated, last_updated_by) VALUES \r\n(''_VACANCY_ID_'', ''_STATUS_'', ''_USER_ID_'', NOW(), ''_ADDED_BY_'', NOW(), ''_ADDED_BY_'')'),
(99, 'get_job_parties', '(SELECT ''_APPLICANT_'' AS user_id) \r\nUNION \r\n(SELECT id AS user_id FROM user WHERE permission_group_id=''10'') \r\nUNION \r\n(SELECT U.id AS user_id FROM user U LEFT JOIN vacancy V ON (V.added_by=U.id OR V.last_updated_by=U.id) WHERE V.id=''_VACANCY_ID_'')'),
(100, 'get_job_applications', 'SELECT DISTINCT \nA.id AS application_id, \nA.status AS application_status, \nA.date_added AS submission_date, \nA.user_id AS applicant_id, \n\n(SELECT CONCAT(P.last_name, '' '', P.first_name) FROM user U LEFT JOIN person P ON (U.person_id=P.id) WHERE U.id=A.user_id LIMIT 1) AS applicant_name, \n\nIF((SELECT id FROM recommendation WHERE recommended_by=''_VIEWED_BY_'' AND change_application_id=A.id AND application_type=''job'' LIMIT 1) IS NOT NULL, ''Y'', ''N'') AS has_recommended, \n\n(SELECT COUNT(id) FROM recommendation WHERE change_application_id=A.id AND application_type=''job'') AS recommendation_count,\n\nV.id, V.start_date, V.end_date, V.topic, V.summary, V.status, \nI.name AS institution_name, \nD.name AS role_name \n\nFROM application A \nLEFT JOIN vacancy V ON (A.vacancy_id=V.id) \nLEFT JOIN institution I ON (V.school_id=I.id) \nLEFT JOIN duty D ON (V.role_id=D.id) \nLEFT JOIN posting PS ON (PS.postee_id=A.user_id)\n\nWHERE _SEARCH_QUERY_ \nORDER BY _ORDER_BY_ LIMIT _LIMIT_TEXT_;'),
(101, 'save_user_job', 'INSERT IGNORE INTO saved_vacancies (user_id, vacancy_id, date_added) VALUES (''_USER_ID_'', ''_VACANCY_ID_'', NOW())'),
(102, 'remove_user_job', 'DELETE FROM saved_vacancies WHERE user_id=''_USER_ID_'' AND vacancy_id=''_VACANCY_ID_'''),
(103, 'get_saved_jobs', 'SELECT * FROM saved_vacancies WHERE user_id=''_USER_ID_'''),
(104, 'get_interview_vacancies', 'SELECT \nI2.id,\nV.topic AS job, \nV.id AS job_id, \n(SELECT COUNT(id) FROM note WHERE parent_id=I2.id AND parent_type=''interview'') AS note_count, \nCONCAT(P.last_name, '' '', P.first_name) AS applicant,\n(SELECT CONCAT(P2.last_name, '' '', P2.first_name) FROM user U2 LEFT JOIN person P2 ON (P2.id=U2.person_id) WHERE U2.id=I2.interviewer_id) AS interviewer, \nI2.interview_date,\nI2.interview_duration,\nI2.result,\nI2.notes, \nA.user_id AS applicant_id\n\nFROM interview I2 \nLEFT JOIN application A ON (I2.application_id=A.id) \nLEFT JOIN vacancy V ON (A.vacancy_id=V.id) \nLEFT JOIN institution I ON (I.id=V.school_id)\n\nLEFT JOIN user U ON (U.id=A.user_id)\nLEFT JOIN person P ON (U.person_id=P.id)\n\nWHERE _SEARCH_QUERY_ ORDER BY _ORDER_BY_ LIMIT _LIMIT_TEXT_'),
(105, 'add_recommendation', 'INSERT IGNORE INTO recommendation (change_application_id, application_type, recommended_by, notes, date_added, added_by) VALUES (''_CHANGE_APPLICATION_ID_'', ''_APPLICATION_TYPE_'', ''_RECOMMENDED_BY_'', ''_NOTES_'', NOW(), ''_ADDED_BY_'')'),
(106, 'get_application_recommendations', 'SELECT R.*, \nCONCAT(P.last_name, '' '', P.first_name) AS recommender, \n(SELECT name FROM institution WHERE id=PS.institution_id LIMIT 1) AS recommender_school, \n(SELECT name FROM duty WHERE id=PS.role_id LIMIT 1) AS recommender_role\n \nFROM recommendation R \nLEFT JOIN user U ON (R.recommended_by=U.id) \nLEFT JOIN person P ON (U.person_id=P.id) \nLEFT JOIN posting PS ON (PS.postee_id=R.recommended_by AND PS.posting_end_date=''0000-00-00'')\n\nWHERE R.change_application_id=''_APPLICATION_ID_'' AND application_type=''_APPLICATION_TYPE_'' \nORDER BY R.date_added DESC'),
(107, 'get_user_posting', 'SELECT institution_id FROM posting WHERE postee_id=''_USER_ID_'' AND status <> ''reversed'''),
(108, 'add_interview', 'INSERT INTO interview (application_id, interviewer_id, planned_date, interview_date, notes, date_added, added_by, last_updated, last_updated_by) VALUES \r\n\r\n(''_APPLICATION_ID_'', ''_INTERVIEWER_ID_'', ''_PLANNED_DATE_'', ''_PLANNED_DATE_'', ''_NOTES_'', NOW(), ''_ADDED_BY_'', NOW(), ''_ADDED_BY_'')'),
(109, 'get_simple_application_details', 'SELECT * FROM application WHERE id=''_APPLICATION_ID_'''),
(110, 'add_note', 'INSERT INTO note (parent_id, parent_type, details, date_added, added_by) VALUES \r\n(''_PARENT_ID_'', ''_PARENT_TYPE_'', ''_DETAILS_'', NOW(), ''_ADDED_BY_'')'),
(111, 'get_item_notes', 'SELECT N.id, CONCAT(P.last_name, '' '', P.first_name) AS added_by, N.details, N.date_added FROM note N LEFT JOIN user U ON (N.added_by=U.id) LEFT JOIN person P ON (U.person_id=P.id) \r\n\r\nWHERE N.parent_id=''_ITEM_ID_'' AND N.parent_type=''_ITEM_TYPE_'' \r\nORDER BY N.date_added DESC'),
(112, 'get_shortlist_data', 'SELECT DISTINCT shortlist_name AS value, shortlist_name AS display FROM shortlist WHERE _SEARCH_QUERY_ _ORDER_BY_ LIMIT _LIMIT_TEXT_'),
(113, 'update_interview_data', 'UPDATE interview SET interview_date=''_INTERVIEW_DATE_'', interview_duration=''_INTERVIEW_DURATION_'', result=''_RESULT_'', last_updated=NOW(), last_updated_by=''_UPDATED_BY_'' WHERE id=''_INTERVIEW_ID_'''),
(114, 'add_user_to_shortlist', 'INSERT IGNORE INTO shortlist (shortlist_name, vacancy_id, applicant_id, date_added, added_by) VALUES \r\n(''_SHORTLIST_NAME_'', ''_VACANCY_ID_'', ''_APPLICANT_ID_'', NOW(), ''_ADDED_BY_'')'),
(115, 'remove_interview_details', 'DELETE I, N FROM interview I LEFT JOIN note N ON (N.parent_id=I.id AND N.parent_type=''interview'') WHERE I.id=''_INTERVIEW_ID_'''),
(116, 'get_interview_shortlists', 'SELECT  DISTINCT S.vacancy_id,  S.vacancy_id AS id, S.shortlist_name, V.topic AS job, I.name AS institution_name \r\nFROM shortlist S \r\nLEFT JOIN vacancy V ON (V.id=S.vacancy_id) \r\nLEFT JOIN institution I ON (I.id=V.school_id) \r\nLEFT JOIN user U ON (U.id=S.applicant_id) \r\nLEFT JOIN person P ON (U.person_id=P.id)\r\n\r\nWHERE _SEARCH_QUERY_ ORDER BY _ORDER_BY_ LIMIT _LIMIT_TEXT_'),
(117, 'get_shortlist_details', 'SELECT S.shortlist_name, CONCAT(P1.last_name, '' '', P1.first_name) AS applicant, S.date_added, CONCAT(P2.last_name, '' '', P2.first_name) AS added_by \r\n\r\nFROM shortlist S \r\nLEFT JOIN user U1 ON (U1.id=S.applicant_id) \r\nLEFT JOIN person P1 ON (U1.person_id=P1.id)\r\nLEFT JOIN user U2 ON (U2.id=S.added_by) \r\nLEFT JOIN person P2 ON (U2.person_id=P2.id) \r\n\r\nWHERE S.vacancy_id=''_VACANCY_ID_'' AND S.shortlist_name=''_SHORTLIST_NAME_'' ORDER BY P1.last_name ASC'),
(118, 'get_duties', 'SELECT *, name AS value, name AS display FROM duty ORDER BY name ASC'),
(119, 'get_managers_for_user', 'SELECT U2.id AS user_id \r\nFROM user U1 \r\nLEFT JOIN posting P1 ON (P1.postee_id=U1.id)\r\nLEFT JOIN posting P2 ON (P2.institution_id=P1.institution_id)\r\nLEFT JOIN user U2 ON (P2.postee_id=U2.id AND U2.permission_group_id=''3'')\r\n\r\nWHERE U2.id IS NOT NULL AND U1.id=''_TEACHER_ID_'''),
(120, 'get_caos_for_user', 'SELECT U2.id AS user_id \r\n\r\nFROM user U1 \r\nLEFT JOIN address A1 ON (U1.person_id=A1.parent_id AND A1.parent_type=''person'' AND A1.importance=''contact'') \r\nLEFT JOIN address A2 ON (((A2.county <> '''' AND A2.county=A1.county) OR (A2.county = '''' AND A2.district_id=A1.district_id)) AND A2.importance=''contact'') \r\nLEFT JOIN user U2 ON (U2.person_id=A2.parent_id AND A2.parent_type=''person'' AND U2.permission_group_id=''12'') \r\n\r\nWHERE U2.id IS NOT NULL AND U1.id=''_TEACHER_ID_'''),
(121, 'add_posting_data', 'INSERT INTO posting (postee_id, institution_id, posting_start_date, posting_end_date, notes, role_id, final_interview_id, status, date_added, added_by, last_updated, last_updated_by)\r\n\r\n(SELECT ''_POSTEE_ID_'' AS postee_id, school_id AS institution_id, NOW() AS posting_start_date, ''0000-00-00'' AS posting_end_date, ''_NOTES_'' AS notes, role_id AS role_id, ''_FINAL_INTERVIEW_ID_'' AS final_interview_id, ''_STATUS_'' AS status, NOW() AS date_added, ''_ADDED_BY_'' AS added_by, NOW() AS last_updated, ''_ADDED_BY_'' AS last_updated_by FROM vacancy WHERE id=''_VACANCY_ID_'')'),
(122, 'get_user_address', 'SELECT A.*, A.details AS addressline, \r\nA.county, \r\n\r\nIF((SELECT name FROM district WHERE id=A.district_id LIMIT 1) IS NOT NULL, (SELECT name FROM district WHERE id=A.district_id LIMIT 1), A.district_id) AS district, \r\n\r\n(SELECT name FROM country WHERE id=A.country_id) AS country \r\n\r\nFROM user U \r\nLEFT JOIN address A ON (A.parent_id=U.person_id AND A.parent_type=''person'' AND importance=''_ADDRESS_TYPE_'')\r\nWHERE A.id IS NOT NULL AND U.id=''_USER_ID_'''),
(123, 'get_job_postings', 'SELECT DISTINCT P.id, P.postee_id, P.final_interview_id, P1.file_number,  P.applied_for_confirmation, P.role_id, P.final_interview_id, P.last_updated_by, \nCONCAT(P1.last_name, '' '', P1.first_name) AS teacher_name, \nD.name AS job, D.description AS job_description, I.name AS institution_name, P.date_added AS award_date, P.posting_start_date AS start_date, P.status AS confirmation_status\n\nFROM posting P \nLEFT JOIN user U ON (U.id = P.postee_id) \nLEFT JOIN person P1 ON (P1.id = U.person_id) \nLEFT JOIN duty D ON (D.id = P.role_id) \nLEFT JOIN institution I ON (I.id = P.institution_id) \nLEFT JOIN address A ON (A.parent_id=I.id AND A.parent_type=''school'')\n\nWHERE _SEARCH_QUERY_ ORDER BY _ORDER_BY_ LIMIT _LIMIT_TEXT_\n'),
(124, 'change_posting_field', 'UPDATE posting SET _FIELD_NAME_=''_FIELD_VALUE_'', last_updated=NOW(), last_updated_by=''_UPDATED_BY_'' WHERE id=''_POSTING_ID_'''),
(125, 'remove_posting_data', 'DELETE FROM posting WHERE id=''_POSTING_ID_'''),
(126, 'update_interview_part', 'UPDATE interview SET _FIELD_NAME_=''_FIELD_VALUE_'', last_updated=NOW(), last_updated_by=''_UPDATED_BY_'' WHERE id=''_INTERVIEW_ID_'''),
(127, 'submit_confirmation_request', 'UPDATE posting SET applied_for_confirmation=''Y'' WHERE id=''_POSTING_ID_'''),
(128, 'get_teacher_jobs', 'SELECT (SELECT name FROM duty WHERE id=P.role_id LIMIT 1) AS job, \r\nI.name AS school, \r\nA.details AS addressline, \r\nA.county, \r\n\r\nIF((SELECT name FROM district WHERE id=A.district_id LIMIT 1) IS NOT NULL, (SELECT name FROM district WHERE id=A.district_id LIMIT 1), A.district_id) AS district, \r\n\r\n(SELECT name FROM country WHERE id=A.country_id) AS country, \r\n\r\nP.posting_start_date AS startdate,\r\nP.posting_end_date AS enddate\r\n\r\nFROM posting P \r\nLEFT JOIN institution I ON (I.id=P.institution_id)\r\nLEFT JOIN address A ON (A.parent_id=I.id AND A.parent_type=''school'')\r\n\r\nWHERE P.postee_id=''_USER_ID_'' _SEARCH_CONDITION_'),
(129, 'get_previous_schools', 'SELECT DISTINCT \r\nI.name AS school, \r\nA.details AS addressline, \r\nA.county, \r\n\r\nIF((SELECT name FROM district WHERE id=A.district_id LIMIT 1) IS NOT NULL, (SELECT name FROM district WHERE id=A.district_id LIMIT 1), A.district_id) AS district, \r\n\r\n(SELECT name FROM country WHERE id=A.country_id) AS country, \r\n\r\n(SELECT GROUP_CONCAT(D.name SEPARATOR '', '') FROM duty D WHERE D.id IN (SELECT role_id FROM posting WHERE institution_id=P.institution_id AND postee_id=''_USER_ID_'')) AS jobs, \r\n\r\n(SELECT MIN(P1.posting_start_date) FROM posting P1 WHERE P1.institution_id=P.institution_id AND P1.status NOT IN (''saved'', ''reversed'') AND P1.postee_id=''_USER_ID_'') AS startdate,\r\n\r\n(SELECT MIN(P2.posting_end_date) FROM posting P2 WHERE P2.institution_id=P.institution_id AND P2.status NOT IN (''saved'', ''reversed'') AND P2.postee_id=''_USER_ID_'') AS enddate\r\n\r\nFROM posting P \r\nLEFT JOIN institution I ON (I.id=P.institution_id)\r\nLEFT JOIN address A ON (A.parent_id=I.id AND A.parent_type=''school'')\r\n\r\nWHERE P.postee_id=''_USER_ID_'' AND P.posting_end_date <> ''0000-00-00'''),
(130, 'add_retirement_application', 'INSERT INTO retirement (retiree_id, retiree_reason, proposed_date, date_added, added_by, last_updated, last_updated_by) VALUES \r\n(''_RETIREE_ID_'', ''_RETIREE_REASON_'', ''_PROPOSED_DATE_'', NOW(), ''_ADDED_BY_'', NOW(), ''_ADDED_BY_'')'),
(131, 'get_retirement_application', 'SELECT R.*, CONCAT(P.last_name, '' '', P.first_name) AS retiree_name \nFROM retirement R \nLEFT JOIN user U ON (U.id=R.retiree_id) \nLEFT JOIN person P ON (P.id=U.person_id)\n\nWHERE R.id=''_APPLICATION_ID_'''),
(132, 'add_promotion_application', 'INSERT INTO promotion (vacancy_id, current_posting_id, reason, proposed_promotion_date, added_by, added_on, last_updated_by, last_updated_on)  \r\n\r\n(SELECT ''_VACANCY_ID_'' AS vacancy_id, id AS current_posting_id, ''_REASON_'' AS reason, ''_PROPOSED_PROMOTION_DATE_'' AS proposed_promotion_date, ''_ADDED_BY_'' AS added_by, NOW() AS added_on, ''_ADDED_BY_'' AS last_updated_by, NOW() AS last_updated_on \r\nFROM posting \r\nWHERE postee_id=''_APPLICANT_ID_'' AND posting_end_date=''0000-00-00'' LIMIT 1)'),
(133, 'get_school_jobs', 'SELECT V.id, V.topic AS value, V.topic AS display \r\nFROM vacancy V \r\nLEFT JOIN posting P ON (P.postee_id=''_USER_ID_'' AND V.school_id=P.institution_id AND P.posting_end_date=''0000-00-00'') \r\n\r\nWHERE P.institution_id IS NOT NULL AND V.status=''published'' AND _SEARCH_QUERY_ LIMIT 100'),
(134, 'get_institution_data', 'SELECT CONCAT(I.name, '' ('', I.district, '', '', I.county, '' '', I.country, '')'') AS display, CONCAT(I.name, '' ('', I.district, '', '', I.county, '' '', I.country, '')'') AS value, I.id \r\n\r\nFROM \r\n(SELECT INS.id, INS.name, \r\n\r\nIF((SELECT name FROM district WHERE id=A.district_id LIMIT 1) IS NOT NULL, (SELECT name FROM district WHERE id=A.district_id LIMIT 1), A.district_id) AS district, \r\n\r\nA.county,\r\n\r\n(SELECT name FROM country WHERE id=A.country_id) AS country\r\n\r\nFROM institution INS \r\nLEFT JOIN address A ON (A.parent_id=INS.id AND A.parent_type=''school'') \r\nWHERE INS.status=''verified'' AND _SEARCH_QUERY_  LIMIT _LIMIT_TEXT_\r\n) I \r\n_ORDER_BY_'),
(135, 'add_transfer_application', 'INSERT INTO transfer (teacher_id, new_school_id, reason, proposed_date, date_added, added_by, last_updated, last_updated_by) VALUES \r\n\r\n(''_TEACHER_ID_'', ''_NEW_SCHOOL_ID_'', ''_REASON_'', ''_PROPOSED_DATE_'', NOW(), ''_ADDED_BY_'', NOW(), ''_ADDED_BY_'')'),
(136, 'add_leave_application', 'INSERT INTO `leave` (teacher_id, 	proposed_start_date, proposed_end_date, reason, date_added, added_by, last_updated, last_updated_by) VALUES \r\n\r\n(''_TEACHER_ID_'', ''_PROPOSED_START_DATE_'', ''_PROPOSED_END_DATE_'', ''_REASON_'', NOW(), ''_ADDED_BY_'', NOW(), ''_ADDED_BY_'')'),
(137, 'get_retirement_list_data', 'SELECT R.*, CONCAT(P.last_name, '' '', P.first_name) AS teacher_name, P.file_number, \r\nIF(P.date_of_birth <> ''0000-00-00'', TIMESTAMPDIFF(YEAR, P.date_of_birth, CURDATE()), ''Unknown'') AS age,\r\n(SELECT D.name FROM duty D WHERE D.id = PS.role_id LIMIT 1) AS job\r\n \r\nFROM retirement R \r\nLEFT JOIN user U ON (R.retiree_id=U.id) \r\nLEFT JOIN person P ON (P.id=U.person_id) \r\nLEFT JOIN posting PS ON (PS.postee_id=R.retiree_id AND PS.posting_end_date=''0000-00-00'') \r\n\r\nWHERE _SEARCH_QUERY_ ORDER BY _ORDER_BY_ LIMIT _LIMIT_TEXT_'),
(138, 'get_leave_list_data', 'SELECT L.*, \r\nCONCAT(P.last_name, '' '', P.first_name) AS teacher_name, \r\nI.name AS school_name,\r\n(SELECT D.name FROM duty D WHERE D.id = PS.role_id LIMIT 1) AS job,\r\nA.details AS addressline, \r\nA.county AS county,\r\n\r\nIF((SELECT name FROM district WHERE id=A.district_id LIMIT 1) IS NOT NULL, (SELECT name FROM district WHERE id=A.district_id LIMIT 1), A.district_id) AS district,\r\n\r\nIF((SELECT name FROM country WHERE id=A.country_id LIMIT 1) IS NOT NULL, (SELECT name FROM country WHERE id=A.country_id LIMIT 1), A.country_id) AS country  \r\n\r\nFROM `leave` L \r\nLEFT JOIN user U ON (U.id=L.teacher_id) \r\nLEFT JOIN person P ON (P.id=U.person_id) \r\nLEFT JOIN posting PS ON (PS.postee_id=L.teacher_id AND PS.posting_end_date=''0000-00-00'') \r\nLEFT JOIN institution I ON (I.id=PS.institution_id)\r\nLEFT JOIN address A ON (A.parent_id=I.id AND A.parent_type=''school'')\r\n\r\nWHERE _SEARCH_QUERY_ ORDER BY _ORDER_BY_ LIMIT _LIMIT_TEXT_'),
(139, 'get_transfer_list_data', 'SELECT T.*, \nCONCAT(P.last_name, '' '', P.first_name) AS teacher_name, \n\n(SELECT name FROM institution WHERE id=PS.institution_id LIMIT 1) AS current_school_name, \n\nI.name AS desired_school_name, \nA.details AS addressline, \nA.county AS county, \n(SELECT D.name FROM duty D WHERE D.id=PS.role_id LIMIT 1) AS old_job, \n\nIF((SELECT name FROM district WHERE id=A.district_id LIMIT 1) IS NOT NULL, (SELECT name FROM district WHERE id=A.district_id LIMIT 1), A.district_id) AS district,\n\nIF((SELECT name FROM country WHERE id=A.country_id LIMIT 1) IS NOT NULL, (SELECT name FROM country WHERE id=A.country_id LIMIT 1), A.country_id) AS country   \n\nFROM transfer T \nLEFT JOIN user U ON (U.id=T.teacher_id) \nLEFT JOIN person P ON (P.id=U.person_id) \nLEFT JOIN institution I ON (T.new_school_id=I.id)\nLEFT JOIN address A ON (A.parent_id=I.id AND A.parent_type=''school'') \nLEFT JOIN posting PS ON (PS.postee_id=T.teacher_id)\n\nWHERE _SEARCH_QUERY_ ORDER BY _ORDER_BY_ LIMIT _LIMIT_TEXT_'),
(140, 'get_log_list_data', 'SELECT L.*, CONCAT(P.last_name, '' '', P.first_name) AS user_name \r\n\r\nFROM `log` L \r\nLEFT JOIN user U ON (L.details LIKE CONCAT(''%userid='',U.id,''|%'')) \r\nLEFT JOIN person P ON (P.id=U.person_id) \r\nWHERE _SEARCH_QUERY_ ORDER BY _ORDER_BY_ LIMIT _LIMIT_TEXT_'),
(141, 'change_transfer_field', 'UPDATE transfer SET _FIELD_NAME_=''_FIELD_VALUE_'', last_updated_by=''_UPDATED_BY_'', last_updated=NOW() WHERE id=''_TRANSFER_ID_'''),
(142, 'terminate_teacher_posting', 'UPDATE posting \r\nSET posting_end_date=NOW(), last_updated=NOW(), last_updated_by=''_UPDATED_BY_'' \r\nWHERE id=''_POSTING_ID_'''),
(143, 'add_plain_posting', 'INSERT INTO posting (postee_id, institution_id, posting_start_date, posting_end_date, notes, role_id, status, final_interview_id, applied_for_confirmation, date_added, added_by, last_updated, last_updated_by) VALUES \n\n(''_POSTEE_ID_'', ''_INSTITUTION_ID_'', NOW(), ''0000-00-00'', ''_NOTES_'', ''_ROLE_ID_'', ''_STATUS_'', ''_FINAL_INTERVIEW_ID_'', ''N'', NOW(), ''_ADDED_BY_'', NOW(), ''_ADDED_BY_'')'),
(144, 'remove_transfer_record', 'DELETE FROM transfer WHERE id=''_TRANSFER_ID_'''),
(145, 'change_leave_field', 'UPDATE `leave` SET _FIELD_NAME_=''_FIELD_VALUE_'', last_updated_by=''_UPDATED_BY_'', last_updated=NOW() WHERE id=''_LEAVE_ID_'''),
(146, 'remove_leave_record', 'DELETE FROM `leave` WHERE id=''_LEAVE_ID_'''),
(147, 'update_leave_dates', 'UPDATE `leave` SET actual_start_date=''_ACTUAL_START_DATE_'', actual_end_date=''_ACTUAL_END_DATE_'' WHERE id=''_LEAVE_ID_'''),
(148, 'change_retirement_field', 'UPDATE retirement SET _FIELD_NAME_=''_FIELD_VALUE_'', last_updated_by=''_UPDATED_BY_'', last_updated=NOW() WHERE id=''_RETIREMENT_ID_''');
INSERT INTO query (id, code, details) VALUES
(149, 'remove_retirement_record', 'DELETE FROM retirement WHERE id=''_RETIREMENT_ID_'''),
(150, 'remove_transfer_application', 'DELETE FROM transfer WHERE teacher_id=''_TEACHER_ID_'' AND status=''pending'''),
(151, 'remove_leave_application', 'DELETE FROM `leave` WHERE teacher_id=''_TEACHER_ID_'' AND status=''pending'''),
(152, 'remove_retirement_application', 'DELETE FROM retirement WHERE retiree_id=''_RETIREE_ID_'' AND status=''pending'''),
(153, 'validate_system_document', 'SELECT D.*, CONCAT(P.last_name, '' '', P.first_name) AS owner_name \nFROM document D LEFT JOIN person P ON (P.id=D.parent_id AND D.parent_type=''person'') WHERE document_type=''_DOCUMENT_TYPE_'' AND tracking_number=''_TRACKING_NUMBER_'''),
(154, 'add_system_document', 'INSERT INTO document (url, document_type, tracking_number, description, parent_id, parent_type, date_added) VALUES \r\n(''_URL_'', ''_DOCUMENT_TYPE_'', ''_TRACKING_NUMBER_'', ''_DESCRIPTION_'', ''_PARENT_ID_'', ''_PARENT_TYPE_'', NOW())'),
(155, 'get_county_list_data', 'SELECT C.name, D.name AS district_name, C.name AS value, C.name AS display \r\nFROM county C \r\nLEFT JOIN district D ON (C.district_id=D.id) \r\nWHERE _SEARCH_QUERY_ ORDER BY _ORDER_BY_ LIMIT _LIMIT_TEXT_'),
(156, 'add_approved_school_data', 'INSERT INTO institution (name, \r\n\r\nstart_date, end_date, status, date_added, added_by, last_updated, \r\n\r\nlast_updated_by) VALUES (''_INSTITUTION_NAME_'', ''_START_DATE_'', \r\n\r\n''0000-00-00'', ''verified'', NOW(), ''_ADDED_BY_'', NOW(), \r\n\r\n''_ADDED_BY_'')'),
(157, 'get_schools_with_ids', 'SELECT * FROM institution WHERE id IN (_ID_LIST_)'),
(158, 'add_old_posting', 'INSERT INTO posting (postee_id, institution_id, posting_start_date, posting_end_date, notes, role_id, status, final_interview_id, applied_for_confirmation, date_added, added_by, last_updated, last_updated_by) \r\n\r\n(SELECT ''_POSTEE_ID_'' AS postee_id, ''_INSTITUTION_ID_'' AS institution_id, ''_START_DATE_'' AS posting_start_date, ''0000-00-00'' AS posting_end_date, ''_NOTES_'' AS notes, D.id AS role_id, ''_STATUS_'' AS status, ''_FINAL_INTERVIEW_ID_'' AS final_interview_id, ''_APPLIED_FOR_CONFIRMATION_'' AS applied_for_confirmation, NOW() AS date_added, ''_ADDED_BY_'' AS added_by, NOW() AS last_updated, ''_ADDED_BY_'' AS last_updated_by FROM duty D WHERE D.name=''_JOB_NAME_'' LIMIT 1)'),
(159, 'get_user_documents', 'SELECT D.* FROM document D LEFT JOIN user U ON (U.person_id=D.parent_id AND D.parent_type=''person'') WHERE U.id=''_USER_ID_'' ORDER BY D.date_added DESC');